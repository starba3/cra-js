"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[2435],{50933:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(1413),a=n(45987),o=n(64554),i=n(50533),l=n(36314),s=n(4567),c=n(93517),u=n(83854),d=n(80184);function p(e){var t=e.link,n=e.activeLast,a=e.disabled,l=t.name,s=t.href,c=t.icon,p=(0,r.Z)({typography:"body2",alignItems:"center",color:"text.primary",display:"inline-flex"},a&&!n&&{cursor:"default",pointerEvents:"none",color:"text.disabled"}),f=(0,d.jsxs)(d.Fragment,{children:[c&&(0,d.jsx)(o.Z,{component:"span",sx:{mr:1,display:"inherit","& svg":{width:20,height:20}},children:c}),l]});return s?(0,d.jsx)(i.Z,{component:u.r,href:s,sx:p,children:f}):(0,d.jsxs)(o.Z,{sx:p,children:[" ",f," "]})}var f=["links","action","heading","moreLink","activeLast","sx"];function h(e){var t=e.links,n=e.action,u=e.heading,h=e.moreLink,v=e.activeLast,m=e.sx,Z=(0,a.Z)(e,f),j=t[t.length-1].name;return(0,d.jsxs)(o.Z,{sx:(0,r.Z)({},m),children:[(0,d.jsxs)(l.Z,{direction:"row",alignItems:"center",children:[(0,d.jsxs)(o.Z,{sx:{flexGrow:1},children:[u&&(0,d.jsx)(s.Z,{variant:"h4",gutterBottom:!0,children:u}),!!t.length&&(0,d.jsx)(c.Z,(0,r.Z)((0,r.Z)({separator:(0,d.jsx)(x,{})},Z),{},{children:t.map((function(e){return(0,d.jsx)(p,{link:e,activeLast:v,disabled:e.name===j},e.name||"")}))}))]}),n&&(0,d.jsxs)(o.Z,{sx:{flexShrink:0},children:[" ",n," "]})]}),!!h&&(0,d.jsx)(o.Z,{sx:{mt:2},children:h.map((function(e){return(0,d.jsx)(i.Z,{href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)}))})]})}function x(){return(0,d.jsx)(o.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})}},91617:function(e,t,n){n.d(t,{Ag:function(){return f},DW:function(){return y},ES:function(){return d},G_:function(){return j},OX:function(){return m},Wu:function(){return C},ZN:function(){return Z},iJ:function(){return v},kT:function(){return x},m3:function(){return S},qL:function(){return l},zJ:function(){return c}});var r=n(74165),a=n(15861),o=(n(763),n(38072)),i="https://invoicecollectionsystemapi.azurewebsites.net";function l(){return s.apply(this,arguments)}function s(){return(s=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("".concat(i,"/api/invoices"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){t=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,fetch("".concat(i,"/api/Invoices/Department/").concat(t),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],a="",a=t?"".concat(i,"/api/Invoices/GetInvoicesBySalesConfirmation?salesConfirm=").concat(t):"".concat(i,"/api/Invoices/NotConfirmedBySales"),e.next=5,fetch(a,{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(i,"/api/invoices/").concat(t),{mode:"cors"});case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:return a=e.sent,e.abrupt("return",a);case 9:console.error("Failed to fetch invoice: ".concat(n.status," - ").concat(n.statusText)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:return e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function x(e,t){var n="";switch(e){case-1:case 0:n="".concat(i,"/api/Invoices/").concat(t,"/Edit/Operation");break;case 1:n="".concat(i,"/api/Invoices/").concat(t,"/Edit/installation");break;case 2:n="".concat(i,"/api/Invoices/").concat(t,"/Edit/Sales");break;case 3:n="".concat(i,"/api/Invoices/").concat(t,"/Edit/Collection");break;case 4:n="".concat(i,"/api/Invoices/").concat(t,"/Edit/TenderAndContracts")}return n}function v(e){var t="";switch(e){case-1:case 0:t=o.H.departments.operation.list;break;case 1:t=o.H.departments.installation.list;break;case 2:t=o.H.departments.sales.list;break;case 3:t=o.H.departments.collection.list;break;case 4:t=o.H.departments.tenderAndConract.list}return t}function m(){return"".concat(i,"/api/ExcelImport/import-invoices")}function Z(e){return"".concat(i,"/api/Attachments/").concat(e)}function j(){return g.apply(this,arguments)}function g(){return(g=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("".concat(i,"/api/CollectionData"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){t=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},console.log("".concat(i,"/api/Invoices/").concat(t,"/Inquiry")),e.next=4,fetch("".concat(i,"/api/Invoices/").concat(t,"/Inquiry"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return w.apply(this,arguments)}function w(){return(w=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],t){e.next=3;break}return e.abrupt("return",n);case 3:return a=t.reduce((function(e,t){return"".concat(e,"customerIds=").concat(t,"&")}),""),e.next=6,fetch("".concat(i,"/api/Invoices/GetInvoicesForCustomers?").concat(a),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){console.log(e),n=[]}));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return k.apply(this,arguments)}function k(){return(k=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!0,e.next=3,fetch("".concat(i,"/api/Invoices/").concat(t,"/Delete"),{mode:"cors",method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},Cache:"default"}).then((function(e){if(e.ok){if(204===e.status)return null;if(200===e.status)return e.json();throw new Error("Unexpected status code: ".concat(e.status))}throw new Error("Network response was not ok")})).then((function(e){console.log("Deleted successfuly")})).catch((function(e){console.log(e),n=!1}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},42628:function(e,t,n){n.d(t,{LR:function(){return l},Ok:function(){return i},SA:function(){return o}});var r=n(80831),a=function(e){return(0,(0,r.Z)().t)(e)};function o(){return[{value:"All",text:a("all")},{value:"Nupco",text:a("nupco")},{value:"Etimad",text:a("etimad")},{value:"Cash",text:a("cash")},{value:"Private",text:a("private")}]}function i(){return[{value:"Ready",text:a("ready")},{value:"Not Ready",text:a("notReady")},{value:"Reject",text:a("reject")}]}function l(){return["0","30","60","90","120"]}},41557:function(e,t,n){n.d(t,{b:function(){return o},j:function(){return i}});var r=n(80831),a=function(e){return(0,(0,r.Z)().t)(e)},o=function(){return[a("All"),a("Operation"),a("Sales"),a("Installation"),a("Collection"),a("TenderAndContracts")]},i=function(){return[a("Operation"),a("Installation"),a("Sales"),a("Collection"),a("TenderAndContracts")]}},44557:function(e,t,n){n.r(t),n.d(t,{default:function(){return pe}});var r=n(6907),a=n(19208),o=n(74165),i=n(15861),l=n(29439),s=n(72791),c=n(69931),u=n(89164),d=n(13239),p=n(38072),f=n(91617),h=n(60720),x=n(50933),v=n(4942),m=n(1413),Z=n(8007),j=n(61134),g=n(44695),y=n(12258),b=n(57621),S=n(36314),w=n(5849),C=n(5574),k=n(97123),D=n(39157),T=n(51691),I=n(65661),N=n(41557),L=n(22459),E=n(39231),A=n(94721),R=n(48550),z=n(63466),F=n(4567),_=n(38887),O=n(27216),H=n(80184);function P(e){e.currentInvoice;var t=(0,j.Gc)(),n=t.control,r=(t.watch,t.setValue,t.formState.errors,(0,_.F)("up","md")),a=(0,c.nt)().t,o=function(e){return a(e)};return(0,H.jsxs)(S.Z,{spacing:{xs:3,md:5},direction:{xs:"column",md:"row"},divider:(0,H.jsx)(A.Z,{flexItem:!0,orientation:r?"vertical":"horizontal",sx:{borderStyle:"dashed"}}),sx:{p:3},children:[(0,H.jsxs)(S.Z,{sx:{width:1},children:[(0,H.jsx)(S.Z,{direction:"row",alignItems:"center",sx:{mb:1},children:(0,H.jsxs)(F.Z,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:[o("attachment"),":"]})}),(0,H.jsx)(R.Z,{type:"file",id:"file",variant:"outlined",inputProps:{accept:".xls, .xlsx"}})]}),(0,H.jsxs)(S.Z,{sx:{width:1},children:[(0,H.jsx)(S.Z,{direction:"row",alignItems:"center",sx:{mb:1},children:(0,H.jsxs)(F.Z,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:[o("newNote"),":"]})}),(0,H.jsx)(j.Qr,{name:"CreateNote",control:n,render:function(e){var t=e.field;return(0,H.jsx)(R.Z,{fullWidth:!0,value:t.value,onChange:function(e){t.onChange(e)},placeholder:o("newNotePlaceHolder"),InputProps:{startAdornment:(0,H.jsx)(z.Z,{position:"start",children:(0,H.jsx)(O.Z,{icon:"eva:search-fill",sx:{color:"text.add"}})})}})}})]})]})}var W=n(53106),B=n(62861),M=n(68096),V=n(77196),G=n(82626),Q=n(58406),q=n(80831),U=function(e){return(0,(0,q.Z)().t)(e)},J=function(){return[U("None"),U("Acknowledged"),U("NotAcknowledged"),U("TempAcknowledged"),U("Reject")]},K=function(e){return(0,(0,q.Z)().t)(e)},X=function(){return[K("NotStarted"),K("InProgress"),K("Installed"),K("Delayed")]},$=n(42628),Y=n(64554),ee=n(79836),te=n(9195),ne=n(56890),re=n(68745),ae=n(53382),oe=n(24308),ie=n(39281),le=n(47974);function se(e){var t=e.department,n=(e.filters,e.onFilters,e.departmentOptions),r=e.currentInvoice,a=(0,s.useState)(!0),u=(0,l.Z)(a,2),d=(u[0],u[1]),p=(0,s.useState)([]),h=(0,l.Z)(p,2),x=h[0],v=h[1],m=(0,s.useState)([]),Z=(0,l.Z)(m,2),g=Z[0],y=Z[1],S=(0,s.useState)([]),w=(0,l.Z)(S,2),C=w[0],k=w[1],D=(0,s.useState)([]),T=(0,l.Z)(D,2),I=T[0],N=T[1],L=(0,s.useState)(null===r||void 0===r?void 0:r.collectionSource),E=(0,l.Z)(L,2),z=E[0],_=(E[1],(0,s.useState)(null===r||void 0===r?void 0:r.claimStatus)),O=(0,l.Z)(_,2),P=O[0],q=(O[1],(0,s.useState)(null===r||void 0===r?void 0:r.claimsDetailStatus)),U=(0,l.Z)(q,2),K=U[0],se=(U[1],(0,s.useState)("")),ce=(0,l.Z)(se,2),ue=ce[0],de=ce[1],pe=(0,s.useState)(!1),fe=(0,l.Z)(pe,2),he=fe[0],xe=fe[1],ve=(0,c.nt)().t,me=function(e){return ve(e)},Ze=(0,j.Gc)(),je=Ze.control,ge=Ze.watch,ye=Ze.resetField,be=Ze.setValue,Se=(Ze.formState.errors,ge());(0,s.useEffect)((function(){var e=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,f.G_)();case 3:t=e.sent,v(t),y(t.filter((function(e){return"Collection Source"===e.entityType}))),console.log(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching invoice:",e.t0);case 12:return e.prev=12,d(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,s.useEffect)((function(){g.length>0&&xe(!0)}),[xe,g]),(0,s.useEffect)((function(){he&&!ue&&(be("collectionSource",z),de(z),de((function(e){var t=z,n=g.filter((function(e){return e.value===z}))[0].id,r=x.filter((function(e){return e.parentId===n}));k(r),be("claimStatus",P);var a=r.filter((function(e){return e.value===P}))[0].id;return N(x.filter((function(e){return e.parentId===a}))),be("claimsDetailStatus",K),t})))}),[he,be,g,x,k,de,N,z,K,P,ue]),g||(console.log("collectionSource[0]: ",g),Ce(g[0]));var we={daysToCollect:["collection"],deliveryDate:["operation"],department:["operation","sales","collection","tenderandcontracts"],acknowledgeStatuses:["operation","sales"],installationStatus:["installation"],installationDate:["installation"],collectionSource:["collection"],claimStatus:["collection"],claimsDetailStatus:["collection"]},Ce=function(e){k([]),N([]),ye("claimStatus"),ye("claimsDetailStatus");var t=g.filter((function(t){return t.value===e.target.value}))[0].id;k(x.filter((function(e){return e.parentId===t}))),C.length&&(be("claimStatus",C[0].value),ke(C[0].value))},ke=function(e){var t=C.filter((function(t){return t.value===e}))[0].id;N(x.filter((function(e){return e.parentId===t})))},De={},Te={width:"95%",margin:"10px",borderRadius:"10px"},Ie={width:"95%",margin:"10px"},Ne=we.deliveryDate.includes(t.toLowerCase())?(0,H.jsx)(j.Qr,{name:"DeliveryDate",control:je,render:function(e){var t=e.field;e.fieldState.error;return(0,H.jsx)(W.M,{label:me("deliveryDate"),value:t.value,onChange:function(e){t.onChange(e)},sx:Te})}}):(0,H.jsx)(R.Z,{label:me("deliveryDate"),value:r.deliveryDate&&r.deliveryDate.substring(0,null===r||void 0===r?void 0:r.deliveryDate.indexOf("T")),disabled:!0,style:Ie}),Le=we.daysToCollect.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:Ie,children:[(0,H.jsxs)(B.Z,{children:[" ",me("daysToCollected")," "]}),(0,H.jsx)(j.Qr,{name:"daysToCollect",control:je,render:function(e){var t=e.field;return(0,H.jsx)(Q.Z,{style:De,value:t.value,onChange:function(e){t.onChange(e)},input:(0,H.jsx)(V.Z,{label:me("daysToCollected")}),renderValue:function(e){return e},sx:{flex:1,textField:{textTransform:"capitalize",fullWidth:!0}},children:(0,$.LR)().map((function(e,t){return(0,H.jsx)(G.Z,{value:e,children:e},t)}))})}})]}):(0,H.jsx)(R.Z,{label:me("daysToCollected"),value:r.daysToCollected,disabled:!0,style:Ie}),Ee=we.department.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:Ie,children:[(0,H.jsxs)(B.Z,{children:[" ",me("department")," "]}),(0,H.jsx)(j.Qr,{name:"department",control:je,render:function(e){var t=e.field;return(0,H.jsx)(Q.Z,{style:De,value:t.value,onChange:function(e){t.onChange(e)},input:(0,H.jsx)(V.Z,{label:me("department")}),renderValue:function(e){return e},sx:{flex:1,textField:{textTransform:"capitalize",fullWidth:!0}},children:n.map((function(e,t){return(0,H.jsx)(G.Z,{value:e,children:e},t)}))})}})]}):(0,H.jsx)(R.Z,{label:me("department"),value:null===r||void 0===r?void 0:r.department,style:Ie,disabled:!0}),Ae=we.acknowledgeStatuses.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:Ie,children:[(0,H.jsx)(B.Z,{children:" Acknowledge Status "}),(0,H.jsx)(j.Qr,{name:"acknowledgeStatus",control:je,render:function(e){var n=e.field;return(0,H.jsx)(Q.Z,{style:De,value:n.value,onChange:function(e){n.onChange(e)},input:(0,H.jsx)(V.Z,{label:me("acknowledgeStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:J().map((function(e){return(0,H.jsx)(G.Z,{value:e,defaultChecked:e===t,children:e},e)}))})}})]}):(0,H.jsx)(R.Z,{label:me("acknowledgeStatus"),value:null===r||void 0===r?void 0:r.acknowledgeStatus,style:Ie,disabled:!0}),Re=we.installationDate.includes(t.toLowerCase())?(0,H.jsx)(j.Qr,{name:"installationDate",control:je,render:function(e){var t=e.field;e.fieldState.error;return(0,H.jsx)(W.M,{label:me("installationDate"),value:t.value,onChange:function(e){t.onChange(e)},sx:Te})}}):(0,H.jsx)(R.Z,{label:me("installationDate"),value:r.installationDate,style:Ie,disabled:!0}),ze=we.installationStatus.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:Ie,children:[(0,H.jsx)(B.Z,{children:me("installationStatus")}),(0,H.jsx)(j.Qr,{name:"installationStatus",control:je,render:function(e){var t=e.field;return(0,H.jsx)(Q.Z,{style:De,value:t.value,onChange:function(e){t.onChange(e)},input:(0,H.jsx)(V.Z,{label:me("installationStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:X().map((function(e,t){return(0,H.jsx)(G.Z,{value:e,children:e},t)}))})}})]}):(0,H.jsx)(R.Z,{label:me("installationStatus"),value:r.installationStatus,style:Ie,disabled:!0}),Fe=we.collectionSource.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:Ie,children:[(0,H.jsxs)(B.Z,{children:[" ",me("collectionSource")," "]}),(0,H.jsx)(j.Qr,{name:"collectionSource",control:je,render:function(e){var t=e.field;return(0,H.jsx)(Q.Z,{style:De,value:t.value,onChange:function(e){de(e.target.value),t.onChange(e),Ce(e)},input:(0,H.jsx)(V.Z,{label:me("collectionSource")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:g&&g.map((function(e,t){return(0,H.jsx)(G.Z,{value:e.value,children:e.value},t)}))})}})]}):(0,H.jsx)(R.Z,{label:me("collectionSource"),value:r.collectionSource,style:Ie,disabled:!0}),_e=we.claimStatus.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:Ie,children:[(0,H.jsx)(B.Z,{children:" Claim Status "}),(0,H.jsx)(j.Qr,{name:"claimStatus",control:je,render:function(e){var t=e.field;return(0,H.jsx)(Q.Z,{style:De,value:t.value,onChange:function(e){t.onChange(e),function(e){var t=C.filter((function(t){return t.value===e.target.value}))[0].id;N(x.filter((function(e){return e.parentId===t}))),ye("claimsDetailStatus")}(e)},input:(0,H.jsx)(V.Z,{label:me("claimStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:C.map((function(e,t){return(0,H.jsx)(G.Z,{value:e.value,children:e.value},t)}))})}})]}):(0,H.jsx)(R.Z,{label:me("claimStatus"),value:r.claimStatus,style:Ie,disabled:!0}),Oe=we.claimsDetailStatus.includes(t.toLowerCase())?(0,H.jsxs)(M.Z,{sx:{flex:1,flexShrink:0,width:{xs:3,md:"80%"}},style:Ie,children:[(0,H.jsx)(B.Z,{children:" Claims Detail Status "}),(0,H.jsx)(j.Qr,{name:"claimsDetailStatus",control:je,render:function(e){var t=e.field;return(0,H.jsx)(Q.Z,{style:De,value:t.value,onChange:function(e){t.onChange(e),console.log(Se)},input:(0,H.jsx)(V.Z,{label:me("claimsDetailStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:I.map((function(e,t){return(0,H.jsx)(G.Z,{value:e.value,children:e.value},t)}))})}})]}):(0,H.jsx)(R.Z,{label:me("claimsDetailStatus"),value:r.claimsDetailStatus,style:Ie,disabled:!0}),He=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(F.Z,{variant:"h6",gutterBottom:!0,children:me("notes")}),(0,H.jsx)(ie.Z,{sx:{overflow:"unset",mt:5},children:(0,H.jsx)(le.Z,{children:(0,H.jsxs)(ee.Z,{sx:{minWidth:960},children:[(0,H.jsx)(ne.Z,{children:(0,H.jsxs)(te.Z,{children:[(0,H.jsx)(re.Z,{width:40,children:"#"}),(0,H.jsx)(re.Z,{sx:{typography:"subtitle2"},children:me("note")}),(0,H.jsx)(re.Z,{sx:{typography:"subtitle2"},children:me("user")}),(0,H.jsx)(re.Z,{sx:{typography:"subtitle2"},children:me("createDate")})]})}),(0,H.jsx)(ae.Z,{children:null===r||void 0===r?void 0:r.notes.map((function(e,t){return(0,H.jsxs)(te.Z,{children:[(0,H.jsx)(re.Z,{children:t+1}),(0,H.jsx)(re.Z,{children:(0,H.jsx)(F.Z,{variant:"subtitle2",children:e.noteText})}),(0,H.jsx)(re.Z,{children:e.createdBy}),(0,H.jsx)(re.Z,{children:e.createdDate.substring(0,e.createdDate.indexOf("T"))})]},t)}))})]})})})]}),Pe=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(F.Z,{variant:"h6",gutterBottom:!0,children:me("attachments")}),(0,H.jsx)(ie.Z,{sx:{overflow:"unset",mt:5,mb:7},children:(0,H.jsx)(le.Z,{children:(0,H.jsxs)(ee.Z,{sx:{minWidth:960},children:[(0,H.jsx)(ne.Z,{children:(0,H.jsxs)(te.Z,{children:[(0,H.jsx)(re.Z,{width:40,children:"#"}),(0,H.jsx)(re.Z,{sx:{typography:"subtitle2"},children:me("name")}),(0,H.jsx)(re.Z,{sx:{typography:"subtitle2"},children:me("user")}),(0,H.jsx)(re.Z,{sx:{typography:"subtitle2"},children:me("createDate")})]})}),(0,H.jsx)(ae.Z,{children:null===r||void 0===r?void 0:r.attachments.map((function(e,t){return(0,H.jsxs)(te.Z,{children:[(0,H.jsx)(re.Z,{children:t+1}),(0,H.jsx)(re.Z,{children:(0,H.jsxs)(F.Z,{variant:"subtitle2",children:[" ",(0,H.jsx)("a",{target:"_blank",rel:"noreferrer",href:e.attachmentPath,children:e.fileName})," "]})}),(0,H.jsx)(re.Z,{children:e.createdBy}),(0,H.jsx)(re.Z,{children:e.createdDate.substring(0,e.createdDate.indexOf("T"))})]},t)}))})]})})})]});oe.Z,oe.Z,F.Z,F.Z,oe.Z,F.Z,F.Z;return(0,H.jsxs)(b.Z,{sx:{pt:5,px:5},children:[(0,H.jsxs)(Y.Z,{rowGap:1,display:"grid",alignItems:"center",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[(0,H.jsx)(R.Z,{label:me("issueDate"),value:r?null===r||void 0===r?void 0:r.issueInvoiceDate.substring(0,null===r||void 0===r?void 0:r.issueInvoiceDate.indexOf("T")):"",style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("amount"),value:null===r||void 0===r?void 0:r.invoiceAmount,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("currency"),value:null===r||void 0===r?void 0:r.currency,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("customerCode"),value:null===r||void 0===r?void 0:r.customerCode,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("nameEnglish"),value:null===r||void 0===r?void 0:r.customerNameEn,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("nameArabic"),value:null===r||void 0===r?void 0:r.customerNameAr,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("PoNumber"),value:null===r||void 0===r?void 0:r.customerPO,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("POValue"),value:null===r||void 0===r?void 0:r.poValue,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("region"),value:null===r||void 0===r?void 0:r.region,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("contractNumber"),value:null===r||void 0===r?void 0:r.contractNo,style:Ie,disabled:!0}),Ne,Re,Ee,ze,Le,Ae,Fe,_e,Oe,(0,H.jsx)(R.Z,{label:me("salesConfirm"),value:null===r||void 0===r?void 0:r.salesConfirm,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("createdBy"),value:null===r||void 0===r?void 0:r.createdBy,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("salesTaker"),value:null===r||void 0===r?void 0:r.salesTakerName,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("collectorName"),value:null===r||void 0===r?void 0:r.collectorName,style:Ie,disabled:!0}),(0,H.jsx)(R.Z,{label:me("responsibleEngineerName"),value:null===r||void 0===r?void 0:r.responsibleEngineerName,style:Ie,disabled:!0})]}),He,(0,H.jsx)(A.Z,{sx:{mt:5,borderStyle:"dashed",mb:3}}),Pe]})}var ce=function(e){return[e.toLocaleString("default",{year:"numeric"}),e.toLocaleString("default",{month:"2-digit"}),e.toLocaleString("default",{day:"2-digit"})].join("-")};function ue(e){var t=e.currentInvoice,n=(0,a.tv)(),r=((0,L.k)(),(0,L.k)()),u=((0,c.nt)().t,(0,s.useState)(!1)),d=(0,l.Z)(u,2),p=(d[0],d[1]),h=(0,s.useState)(!1),x=(0,l.Z)(h,2),A=x[0],R=x[1],z=(0,s.useState)(""),F=(0,l.Z)(z,2),_=F[0],O=F[1],W=(0,N.j)().map((function(e){return e.toLocaleLowerCase()})).indexOf(null===t||void 0===t?void 0:t.department.toLowerCase()),B=function(){R(!1)},M={daysToCollect:["collection"],deliveryDate:["operation"],department:["operation","sales","tenderandcontracts","collection"],acknowledgeStatuses:["operation","sales"],installationStatus:["installation"],installationDate:["installation"],collectionSource:["collection"],claimStatus:["collection"],claimsDetailStatus:["collection"]},V=Z.Ry().shape({CreateNote:Z.Z_(),department:Z.Z_(),acknowledgeStatus:Z.Z_(),DeliveryDate:Z.nK().nullable(),installationStatus:Z.Z_(),installationDate:Z.nK().nullable(),collectionSource:Z.Z_(),daysToCollect:Z.Z_(),claimStatus:Z.Z_(),claimsDetailStatus:Z.Z_()}),G=(0,s.useMemo)((function(){return{CreateNote:(null===t||void 0===t?void 0:t.CreateNote)||"",department:(null===t||void 0===t?void 0:t.department)||"",acknowledgeStatus:(null===t||void 0===t?void 0:t.acknowledgeStatus)||"",DeliveryDate:(null===t||void 0===t?void 0:t.DeliveryDate)||new Date,installationStatus:(null===t||void 0===t?void 0:t.installationStatus)||"",installationDate:(null===t||void 0===t?void 0:t.installationDate)||new Date,collectionSource:(null===t||void 0===t?void 0:t.CollectionSource)||"",claimStatus:(null===t||void 0===t?void 0:t.ClaimStatus)||"",daysToCollect:(null===t||void 0===t?void 0:t.daysToCollect)||0,claimsDetailStatus:(null===t||void 0===t?void 0:t.ClaimsDetailStatus)||""}}),[t]),Q=(0,s.useState)(G),q=(0,l.Z)(Q,2),U=q[0],J=q[1],K=(0,j.cI)({resolver:(0,g.X)(V),defaultValues:G}),X=K.reset,$=K.watch,Y=K.handleSubmit,ee=K.formState.isSubmitting,te=(0,s.useCallback)((function(e,t){J((function(n){return(0,m.Z)((0,m.Z)({},n),{},(0,v.Z)({},e,t))}))}),[]),ne=Y(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(a){var i,l,s,c,u,d,h,x,v,m,Z,j,g,y;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re(),r.onTrue(),e.prev=2,e.next=5,new Promise((function(e){return setTimeout(e,500)}));case 5:i=$(),l=i.CreateNote,s=i.department,c=i.acknowledgeStatus,u=i.DeliveryDate,d=i.installationDate,h=i.installationStatus,x=i.collectionSource,v=i.daysToCollect,m=i.claimStatus,Z=i.claimsDetailStatus,j=[],s&&M.department.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/department",value:"".concat(s)}),v&&M.daysToCollect.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/daysToCollected",value:"".concat(v)}),c&&M.acknowledgeStatuses.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/acknowledgeStatus",value:"".concat(c)}),u&&M.deliveryDate.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/DeliveryDate",value:"".concat(ce(u))}),d&&M.installationDate.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/InstallationDate",value:"".concat(ce(d))}),h&&M.installationStatus.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/installationStatus",value:"".concat(h)}),x&&M.collectionSource.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/CollectionSource",value:"".concat(x)}),m&&M.claimStatus.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/ClaimStatus",value:"".concat(m)}),Z&&M.claimsDetailStatus.includes(t.department.toLowerCase())&&j.push({op:"replace",path:"/ClaimsDetailStatus",value:"".concat(Z)}),j.push({op:"add",path:"/CreateNote",value:{NoteText:"".concat(l)}}),X(),g=(0,f.iJ)(W),console.log("Body",JSON.stringify(j)),y=(0,f.kT)(W,t.id),console.log("Url",y),fetch(y,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(j),Cache:"default"}).then((function(e){if(!e.ok){if(400===e.status)return e.text().then((function(e){throw O(e),R(!0),new Error("Bad Request: ".concat(e))}));throw new Error("Network response was not ok")}return e.text()})).then((function(e){p(!0),r.onFalse(),n.replace(g),console.log("res:",e)})).catch((function(e){console.error("Fetch Error:",e)})),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(2),console.error("Error:",e.t0),r.onFalse();case 29:case"end":return e.stop()}}),e,null,[[2,25]])})));return function(t){return e.apply(this,arguments)}}()),re=function(){var e=new FormData,n=document.querySelector("#file").files[0];if(n){e.append("file",n);try{var r=(0,f.ZN)(t.id);console.log("Url",r),fetch(r,{mode:"cors",method:"POST",headers:{Accept:"application/json"},body:e,Cache:"default"}).then(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,3e3)}));case 2:if(t.ok){e.next=9;break}if(400!==t.status&&415!==t.status){e.next=8;break}return e.next=6,t.text();case 6:throw n=e.sent,new Error("Bad Request: ".concat(n));case 8:throw new Error("Network response was not ok");case 9:return e.abrupt("return",t.text());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){})).catch((function(e){console.error("Fetch Error:",e)}))}catch(a){console.log(a)}}};return(0,H.jsxs)(E.ZP,{methods:K,onSubmit:ne,children:[(0,H.jsxs)(b.Z,{children:[(0,H.jsx)(P,{currentInvoice:t}),(0,H.jsx)(se,{currentInvoice:t,filters:U,onFilters:te,departmentOptions:(0,N.j)().map((function(e){return e})),department:t.department})]}),(0,H.jsx)(S.Z,{justifyContent:"flex-end",direction:"row",spacing:2,sx:{mt:3},children:(0,H.jsxs)(y.Z,{size:"large",variant:"contained",loading:r.value&&ee,type:"submit",children:[t?"Update":"Create"," & Send"]})}),(0,H.jsxs)(C.Z,{open:A,color:"#ef5350",keepMounted:!0,onClose:B,"aria-describedby":"alert-dialog-slide-description",className:"dialog-error",children:[(0,H.jsx)(I.Z,{children:"Error"}),(0,H.jsx)(D.Z,{children:(0,H.jsx)(T.Z,{id:"alert-dialog-slide-description",children:String(_)})}),(0,H.jsx)(k.Z,{children:(0,H.jsx)(w.Z,{onClick:B,children:"Ok"})})]})]})}function de(e){var t=e.id,n=(0,h.K$)(),r=(0,c.nt)().t,a=function(e){return r(e)},v=(0,s.useState)(null),m=(0,l.Z)(v,2),Z=m[0],j=m[1],g=(0,s.useState)(!0),y=(0,l.Z)(g,2),b=y[0],S=y[1];return(0,s.useEffect)((function(){var e=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,f.Ag)(t);case 3:n=e.sent,j(n),console.log(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error fetching invoice:",e.t0);case 11:return e.prev=11,S(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]),b||!Z?(0,H.jsx)(d.Z,{}):(0,H.jsxs)(u.Z,{maxWidth:!n.themeStretch&&"lg",children:[(0,H.jsx)(x.Z,{heading:"Edit invoice",links:[{name:a("app"),href:p.H.dashboard.root},{name:a("invoice"),href:p.H.dashboard.invoice.root},{name:a("newInvoice")}],sx:{mb:{xs:3,md:5}}}),(0,H.jsx)(ue,{currentInvoice:Z})]})}function pe(){var e=(0,a.UO)(),t=e.id;return console.log(e),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(r.ql,{children:(0,H.jsx)("title",{children:" Edit invoice"})}),(0,H.jsx)(de,{id:t})]})}},51691:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(63366),a=n(87462),o=n(72791),i=n(59278),l=n(94419),s=n(66934),c=n(31402),u=n(4567),d=n(75878),p=n(21217);function f(e){return(0,p.Z)("MuiDialogContentText",e)}(0,d.Z)("MuiDialogContentText",["root"]);var h=n(80184),x=["children","className"],v=(0,s.ZP)(u.Z,{shouldForwardProp:function(e){return(0,s.FO)(e)||"classes"===e},name:"MuiDialogContentText",slot:"Root",overridesResolver:function(e,t){return t.root}})({}),m=o.forwardRef((function(e,t){var n=(0,c.Z)({props:e,name:"MuiDialogContentText"}),o=n.className,s=(0,r.Z)(n,x),u=function(e){var t=e.classes,n=(0,l.Z)({root:["root"]},f,t);return(0,a.Z)({},t,n)}(s);return(0,h.jsx)(v,(0,a.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:s,className:(0,i.Z)(u.root,o)},n,{classes:u}))}))},65661:function(e,t,n){var r=n(87462),a=n(63366),o=n(72791),i=n(59278),l=n(94419),s=n(4567),c=n(66934),u=n(31402),d=n(17673),p=n(85090),f=n(80184),h=["className","id"],x=(0,c.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:function(e,t){return t.root}})({padding:"16px 24px",flex:"0 0 auto"}),v=o.forwardRef((function(e,t){var n=(0,u.Z)({props:e,name:"MuiDialogTitle"}),s=n.className,c=n.id,v=(0,a.Z)(n,h),m=n,Z=function(e){var t=e.classes;return(0,l.Z)({root:["root"]},d.a,t)}(m),j=o.useContext(p.Z).titleId,g=void 0===j?c:j;return(0,f.jsx)(x,(0,r.Z)({component:"h2",className:(0,i.Z)(Z.root,s),ownerState:m,ref:t,variant:"h6",id:null!=c?c:g},v))}));t.Z=v},68745:function(e,t,n){var r=n(4942),a=n(63366),o=n(87462),i=n(72791),l=n(59278),s=n(94419),c=n(12065),u=n(14036),d=n(46646),p=n(829),f=n(31402),h=n(66934),x=n(90618),v=n(80184),m=["align","className","component","padding","scope","size","sortDirection","variant"],Z=(0,h.ZP)("td",{name:"MuiTableCell",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.variant],t["size".concat((0,u.Z)(n.size))],"normal"!==n.padding&&t["padding".concat((0,u.Z)(n.padding))],"inherit"!==n.align&&t["align".concat((0,u.Z)(n.align))],n.stickyHeader&&t.stickyHeader]}})((function(e){var t=e.theme,n=e.ownerState;return(0,o.Z)({},t.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:t.vars?"1px solid ".concat(t.vars.palette.TableCell.border):"1px solid\n    ".concat("light"===t.palette.mode?(0,c.$n)((0,c.Fq)(t.palette.divider,1),.88):(0,c._j)((0,c.Fq)(t.palette.divider,1),.68)),textAlign:"left",padding:16},"head"===n.variant&&{color:(t.vars||t).palette.text.primary,lineHeight:t.typography.pxToRem(24),fontWeight:t.typography.fontWeightMedium},"body"===n.variant&&{color:(t.vars||t).palette.text.primary},"footer"===n.variant&&{color:(t.vars||t).palette.text.secondary,lineHeight:t.typography.pxToRem(21),fontSize:t.typography.pxToRem(12)},"small"===n.size&&(0,r.Z)({padding:"6px 16px"},"&.".concat(x.Z.paddingCheckbox),{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}),"checkbox"===n.padding&&{width:48,padding:"0 0 0 4px"},"none"===n.padding&&{padding:0},"left"===n.align&&{textAlign:"left"},"center"===n.align&&{textAlign:"center"},"right"===n.align&&{textAlign:"right",flexDirection:"row-reverse"},"justify"===n.align&&{textAlign:"justify"},n.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(t.vars||t).palette.background.default})})),j=i.forwardRef((function(e,t){var n,r=(0,f.Z)({props:e,name:"MuiTableCell"}),c=r.align,h=void 0===c?"inherit":c,j=r.className,g=r.component,y=r.padding,b=r.scope,S=r.size,w=r.sortDirection,C=r.variant,k=(0,a.Z)(r,m),D=i.useContext(d.Z),T=i.useContext(p.Z),I=T&&"head"===T.variant,N=b;"td"===(n=g||(I?"th":"td"))?N=void 0:!N&&I&&(N="col");var L=C||T&&T.variant,E=(0,o.Z)({},r,{align:h,component:n,padding:y||(D&&D.padding?D.padding:"normal"),size:S||(D&&D.size?D.size:"medium"),sortDirection:w,stickyHeader:"head"===L&&D&&D.stickyHeader,variant:L}),A=function(e){var t=e.classes,n=e.variant,r=e.align,a=e.padding,o=e.size,i={root:["root",n,e.stickyHeader&&"stickyHeader","inherit"!==r&&"align".concat((0,u.Z)(r)),"normal"!==a&&"padding".concat((0,u.Z)(a)),"size".concat((0,u.Z)(o))]};return(0,s.Z)(i,x.U,t)}(E),R=null;return w&&(R="asc"===w?"ascending":"descending"),(0,v.jsx)(Z,(0,o.Z)({as:n,ref:t,className:(0,l.Z)(A.root,j),"aria-sort":R,scope:N,ownerState:E},k))}));t.Z=j},46646:function(e,t,n){var r=n(72791).createContext();t.Z=r},829:function(e,t,n){var r=n(72791).createContext();t.Z=r}}]);
//# sourceMappingURL=2435.d05c8722.chunk.js.map