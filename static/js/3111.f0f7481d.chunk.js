"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[3111],{22260:function(e,n,t){t.d(n,{AW:function(){return l},Eq:function(){return a},Fo:function(){return h},fx:function(){return d}});var r=t(93433),o=t(74165),s=t(15861),i="https://invoicecollectionsystemapi.azurewebsites.net";function a(e){return c.apply(this,arguments)}function c(){return(c=(0,s.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("".concat(i,"/api/User/UsersNameByRole/").concat(n),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){t=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(){return u.apply(this,arguments)}function u(){return(u=(0,s.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,fetch("".concat(i,"/api/User"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,s.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("".concat(i,"/api/Invoices/GetInvoicesForUser?User=").concat(n),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){t=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return f.apply(this,arguments)}function f(){return(f=(0,s.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[{id:"0",name:"All"}],e.next=3,fetch("".concat(i,"/api/User/roles"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n.push.apply(n,(0,r.Z)(e))})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},43111:function(e,n,t){t.r(n),t.d(n,{default:function(){return be}});var r=t(6907),o=t(4942),s=t(1413),i=t(74165),a=t(15861),c=t(29439),l=t(31357),u=t.n(l),d=t(72791),p=t(57689),h=t(69931),f=t(13967),x=t(64554),m=t(57621),Z=t(79836),v=t(36314),g=t(5849),j=t(94721),w=t(63515),b=t(89164),y=t(53382),C=t(13400),k=t(39281),D=t(77196),S=t(82626),P=t(58406),R=t(62711),I=t(56125),N=t(5574),E=t(97123),A=t(39157),F=t(65661),O=t(38072),W=t(19208),U=t(22459),_=t(9145),z=t(47974),B=t(3352),L=t(60720),T=t(50933),H=t(27216),M=t(1382),q=t(41557),Q=t(62633),G=t(22260),J=t(11276),K=t(49088),V=t(45987),$=t(85771),X=t(27938),Y=t(25265),ee=t(80184),ne=["filters","onFilters","onResetFilters","results"],te=["label","children","sx"];function re(e){var n,t=e.filters,r=e.onFilters,o=e.onResetFilters,i=e.results,a=(0,V.Z)(e,ne),c=(0,Y.l2)(t.startDate,t.endDate),l=(0,h.nt)().t;return(0,ee.jsxs)(v.Z,(0,s.Z)((0,s.Z)({spacing:1.5},a),{},{children:[(0,ee.jsxs)(x.Z,{sx:{typography:"body2"},children:[(0,ee.jsx)("strong",{children:i}),(0,ee.jsx)(x.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:(n="resultsfound",l(n))})]}),(0,ee.jsxs)(v.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[t.startDate&&t.endDate&&(0,ee.jsx)(oe,{label:"Date:",children:(0,ee.jsx)($.Z,{size:"small",label:c,onDelete:function(){r("startDate",null),r("endDate",null)}})}),(0,ee.jsx)(g.Z,{color:"error",onClick:o,startIcon:(0,ee.jsx)(H.Z,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]}))}function oe(e){var n=e.label,t=e.children,r=e.sx,o=(0,V.Z)(e,te);return(0,ee.jsxs)(v.Z,(0,s.Z)((0,s.Z)({component:X.Z,variant:"outlined",spacing:1,direction:"row",sx:(0,s.Z)({p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed"},r)},o),{},{children:[(0,ee.jsx)(x.Z,{component:"span",sx:{typography:"subtitle2"},children:n}),(0,ee.jsx)(v.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:t})]}))}var se=t(91617),ie=t(16386),ae=t(50533),ce=t(60220),le=t(9195),ue=t(13034),de=t(68745),pe=t(4567),he=t(49900),fe=t(52115);function xe(e){var n=e.row,t=e.selected,r=e.salesStatus,o=e.onSelectRow,s=e.onViewRow,i=e.onEditRow,a=e.onDeleteRow,c=e.handleOpen,l=e.handleConfirmAndReject,u=n.id,d=n.invoiceNo,p=n.issueInvoiceDate,f=n.invoiceAmount,x=n.region,m=n.customerNameEn,Z=n.customerNameAr,v=n.productNameEn,j=n.productNameAr,w=(n.sales,(0,h.nt)()),b=w.t,y=w.currentLang,k="ar"===y.value?Z:m,D="ar"===y.value?j:v,P=function(e){return b(e)},R=(0,U.k)(),I=(0,fe.S)(),N=void 0===r?(0,ee.jsxs)(S.Z,{onClick:function(){i(),I.onClose()},children:[(0,ee.jsx)(H.Z,{icon:"solar:pen-bold"}),P("edit")]}):null,E=0===r?(0,ee.jsx)(de.Z,{children:(0,ee.jsx)(g.Z,{variant:"contained",color:"success",onClick:function(){return l(u,"Confirm")},children:P("accept")})}):null,A=0===r?(0,ee.jsx)(de.Z,{children:(0,ee.jsx)(g.Z,{variant:"contained",color:"error",onClick:function(){return l(u,"Reject")},children:P("reject")})}):null,F=r>0?(0,ee.jsx)(de.Z,{children:(0,ee.jsxs)(g.Z,{variant:"contained",color:"success",onClick:function(){return c(u)},children:[P("assign")," ",P(1===r?"engineer":"collector")]})}):null;return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(le.Z,{hover:!0,selected:t,children:[(0,ee.jsx)(de.Z,{padding:"checkbox",children:(0,ee.jsx)(ue.Z,{checked:t,onClick:o})}),(0,ee.jsxs)(de.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,ee.jsx)(ce.Z,{alt:k,sx:{mr:2},children:k.charAt(0).toUpperCase()}),(0,ee.jsx)(he.Z,{disableTypography:!0,primary:(0,ee.jsx)(pe.Z,{variant:"body2",noWrap:!0,children:k}),secondary:(0,ee.jsx)(ae.Z,{noWrap:!0,variant:"body2",onClick:s,sx:{color:"text.disabled",cursor:"pointer"},children:d})})]}),(0,ee.jsx)(de.Z,{children:(0,ee.jsx)(he.Z,{primary:(0,ie.Z)(new Date(p),"dd MMM yyyy"),secondary:(0,ie.Z)(new Date(p),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),(0,ee.jsxs)(de.Z,{children:["$",f]}),(0,ee.jsx)(de.Z,{align:"center",children:x}),(0,ee.jsx)(de.Z,{align:"center",children:D}),E,A,F,(0,ee.jsx)(de.Z,{align:"right",sx:{px:1},children:(0,ee.jsx)(C.Z,{color:I.open?"inherit":"default",onClick:I.onOpen,children:(0,ee.jsx)(H.Z,{icon:"eva:more-vertical-fill"})})})]}),(0,ee.jsxs)(fe.Z,{open:I.open,onClose:I.onClose,arrow:"right-top",sx:{width:160},children:[(0,ee.jsxs)(S.Z,{onClick:function(){s(),I.onClose()},children:[(0,ee.jsx)(H.Z,{icon:"solar:eye-bold"}),P("view")]}),N]}),(0,ee.jsx)(B.Q,{open:R.value,onClose:R.onFalse,title:P("delete"),content:P("deleteDialogContent"),action:(0,ee.jsx)(g.Z,{variant:"contained",color:"error",onClick:a,children:P("delete")})})]})}var me=t(53106),Ze=t(48550),ve=t(63466);function ge(e){var n=e.filters,t=e.onFilters,r=e.dateError,o=(0,fe.S)(),s=(0,h.nt)().t,i=function(e){return s(e)},a=(0,d.useCallback)((function(e){t("name",e.target.value)}),[t]),c=(0,d.useCallback)((function(e){t("startDate",e)}),[t]),l=(0,d.useCallback)((function(e){t("endDate",e)}),[t]);return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(v.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,ee.jsx)(me.M,{label:i("startDate"),value:n.startDate,onChange:c,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:180}}}),(0,ee.jsx)(me.M,{label:i("endDate"),value:n.endDate,onChange:l,slotProps:{textField:{fullWidth:!0,error:r}},sx:{maxWidth:{md:180}}}),(0,ee.jsx)(v.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:(0,ee.jsx)(Ze.Z,{fullWidth:!0,value:n.name,onChange:a,placeholder:i("searchInvoiceNamePlaceHolder"),InputProps:{startAdornment:(0,ee.jsx)(ve.Z,{position:"start",children:(0,ee.jsx)(H.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]}),(0,ee.jsxs)(fe.Z,{open:o.open,onClose:o.onClose,arrow:"right-top",sx:{width:140},children:[(0,ee.jsxs)(S.Z,{onClick:function(){o.onClose()},children:[(0,ee.jsx)(H.Z,{icon:"solar:printer-minimalistic-bold"}),i("print")]}),(0,ee.jsxs)(S.Z,{onClick:function(){o.onClose()},children:[(0,ee.jsx)(H.Z,{icon:"solar:import-bold"}),i("import")]}),(0,ee.jsxs)(S.Z,{onClick:function(){o.onClose()},children:[(0,ee.jsx)(H.Z,{icon:"solar:export-bold"}),i("export")]})]})]})}var je={name:"",startDate:null,endDate:null};function we(e){var n=e.department,t=e.salesStatus,r=(0,f.Z)(),l=((0,p.s0)(),(0,L.K$)()),V=(0,W.tv)(),$=(0,M.x6)({defaultOrderBy:"issueInvoiceDate"}),X=(0,U.k)(),Y=(0,h.nt)(),ne=Y.t,te=Y.currentLang.value,oe=function(e){return ne(e)},ie=(0,d.useState)([]),ae=(0,c.Z)(ie,2),ce=ae[0],le=ae[1],ue=(0,d.useState)([]),de=(0,c.Z)(ue,2),pe=de[0],he=de[1],fe=(0,d.useState)(!1),me=(0,c.Z)(fe,2),Ze=me[0],ve=me[1];(0,d.useEffect)((function(){var e="";1===t?e="installation":3===t&&(e="collection");var r=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0===n){e.next=9;break}return r=-1===n?0:n,e.next=5,(0,se.zJ)(r);case 5:o=e.sent,he(o),e.next=13;break;case 9:return e.next=11,(0,se.ES)(Boolean(t));case 11:s=e.sent,he(s);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error fetching invoices:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),o=function(){var n=(0,a.Z)((0,i.Z)().mark((function n(){var t;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!e){n.next=8;break}return n.next=4,(0,G.Eq)(e);case 4:t=n.sent,console.log(t),Oe(t.length?t[0].username:""),le(t);case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),console.error("Error fetching users list:",n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();r(),o()}),[n,t]);var we=(0,d.useState)(je),be=(0,c.Z)(we,2),ye=be[0],Ce=be[1],ke=(0,d.useState)(void 0===n),De=(0,c.Z)(ke,2),Se=De[0],Pe=(De[1],(0,d.useState)(!1)),Re=(0,c.Z)(Pe,2),Ie=Re[0],Ne=Re[1],Ee=(0,d.useState)(""),Ae=(0,c.Z)(Ee,2),Fe=Ae[0],Oe=Ae[1],We=(0,d.useState)(0),Ue=(0,c.Z)(We,2),_e=Ue[0],ze=Ue[1],Be=(0,d.useState)(!1),Le=(0,c.Z)(Be,2),Te=Le[0],He=Le[1],Me=(0,d.useState)("Success"),qe=(0,c.Z)(Me,2),Qe=qe[0],Ge=qe[1],Je=!(!ye.startDate||!ye.endDate)&&ye.startDate.getTime()>ye.endDate.getTime(),Ke=function(e){var n=e.inputData,t=e.comparator,r=e.filters,o=e.dateError,s=r.name,i=(r.status,r.service,r.startDate),a=(r.paidStatus,r.endDate),c=n.map((function(e,n){return[e,n]}));c.sort((function(e,n){var r=t(e[0],n[0]);return 0!==r?r:e[1]-n[1]})),n=c.map((function(e){return e[0]})),s&&(n=n.filter((function(e){return-1!==e.customerNameEn.toLowerCase().indexOf(s.toLowerCase())||-1!==e.invoiceNo.toLowerCase().indexOf(s.toLowerCase())||-1!==e.customerNameAr.indexOf(s)})));o||i&&a&&(n=n.filter((function(e){return(0,_.IO)(e.issueInvoiceDate)>=(0,_.IO)(i)&&(0,_.IO)(e.issueInvoiceDate)<=(0,_.IO)(a)})));return n}({inputData:pe,comparator:(0,M.sQ)($.order,$.orderBy),filters:ye,dateError:Je}),Ve=Ke.slice($.page*$.rowsPerPage,$.page*$.rowsPerPage+$.rowsPerPage),$e=function(){Ne(!1)},Xe=$.dense?56:76,Ye=!!ye.name||!!ye.startDate&&!!ye.endDate,en=!Ke.length&&Ye||!Ke.length,nn=[{id:"invoiceNumber",label:oe("invoiceNumber")},{id:"issueInvoiceDate",label:oe("issueDate")},{id:"invoiceAmount",label:oe("amount")},{id:"region",label:oe("region"),align:"center"},{id:"productName",label:oe("productName"),align:"center"},{id:"6",label:""}],tn=[oe("invoiceNumber"),oe("customerName"),oe("issueDate"),oe("amount"),oe("region"),oe("productName")],rn=(0,d.useCallback)((function(e,n){$.onResetPage(),Ce((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,o.Z)({},e,n))}))}),[$]),on=(0,d.useCallback)((function(e){var n=pe.filter((function(n){return n.id!==e}));he(n),$.onUpdatePageDeleteRow(Ve.length)}),[Ve.length,$,pe]),sn=(0,d.useCallback)((function(){var e=pe.filter((function(e){return!$.selected.includes(e.id)}));he(e),$.onUpdatePageDeleteRows({totalRows:pe.length,totalRowsInPage:Ve.length,totalRowsFiltered:Ke.length})}),[Ke.length,Ve.length,$,pe]),an=(0,d.useCallback)((function(e){V.push(O.H.dashboard.invoice.editOperation(e))}),[V]),cn=(0,d.useCallback)((function(e){V.push(O.H.dashboard.invoice.details(e))}),[V]),ln=((0,d.useCallback)((function(e,n){rn("paidStatus",n)}),[rn]),(0,d.useCallback)((function(){Ce(je)}),[])),un=((0,d.useCallback)((function(){Ce(je)}),[]),function(e,n){var t="";if(e)switch(e){case-1:t=oe("operation");break;case 1:t=oe("installation");break;case 2:t=oe("sales");break;case 3:t=oe("collection");break;case 4:t=oe("tenderAndContracts")}else switch(n){case 0:t=oe("confirm_invoices");break;case 1:t=oe("assign_engineer");break;case 2:t=oe("assign_collector")}return t}(n,t));Se&&0===t&&(nn.push({id:"7",label:""}),nn.push({id:"8",label:""})),Se&&t>0&&nn.push({id:"7",label:""});var dn=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{console.log("https://invoicecollectionsystemapi.azurewebsites.net/api/Invoices/".concat(n,"/").concat(t,"BySales")),O.H.departments.sales.confirm_invoices,fetch("https://invoicecollectionsystemapi.azurewebsites.net/api/Invoices/".concat(n,"/").concat(t,"BySales"),{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},Cache:"default"}).then((function(e){if(e.ok){if(ve(!Ze),204===e.status)return null;if(200===e.status)return e.json();throw new Error("Unexpected status code: ".concat(e.status))}throw new Error("Network response was not ok")})).then((function(e){Ge(oe("success"))})).catch((function(e){console.log(e),Ge(e)}))}catch(r){console.error("Error:",r)}finally{He(!0)}case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),pn=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var n,r,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=1===t?"setResponsibleEngineerByUsername":"setCollectorByUsername",r="https://invoicecollectionsystemapi.azurewebsites.net/api/Invoices/".concat(_e,"/").concat(n),console.log(r),o={userName:Fe},console.log(o),Ne(!1),fetch(r,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o),Cache:"default"}).then((function(e){if(e.ok){if(204===e.status)return null;if(200===e.status)return e.json();throw new Error("Unexpected status code: ".concat(e.status))}throw new Error("Network response was not ok")})).then((function(e){Ge(oe("success"))})).catch((function(e){console.log(e),Ge(e)}))}catch(s){console.error("Error:",s)}finally{He(!0)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(b.Z,{maxWidth:!l.themeStretch&&"lg",children:[(0,ee.jsx)(T.Z,{heading:un,links:[{name:oe("app"),href:O.H.dashboard.root},{name:oe("invoice"),href:O.H.dashboard.invoice.root},{name:oe("list")}],action:(0,ee.jsx)(v.Z,{direction:"row",divider:(0,ee.jsx)(j.Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:(0,ee.jsx)(g.Z,{variant:"contained",color:"primary",onClick:function(){return(0,J.p)(pe,tn,te,"InvoiceByDepartments","ExportFile")},startIcon:(0,ee.jsx)(H.Z,{icon:"eva:download-outline"}),children:oe("export")})}),sx:{mb:{xs:3,md:5}}}),(0,ee.jsx)(m.Z,{sx:{mb:{xs:3,md:5}},children:(0,ee.jsx)(z.Z,{children:(0,ee.jsx)(v.Z,{direction:"row",divider:(0,ee.jsx)(j.Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:(0,ee.jsx)(K.Z,{title:oe("total"),total:pe.length,percent:100,price:u()(pe,"invoiceAmount"),icon:"solar:bill-list-bold-duotone",color:r.palette.info.main})})})}),(0,ee.jsxs)(m.Z,{children:[(0,ee.jsx)(ge,{filters:ye,onFilters:rn,dateError:Je,serviceOptions:(0,q.b)().map((function(e){return e})),paidStatusOptions:(0,Q.O)().map((function(e){return e}))}),Ye&&(0,ee.jsx)(re,{filters:ye,onFilters:rn,onResetFilters:ln,results:Ke.length,sx:{p:2.5,pt:0}}),(0,ee.jsx)(k.Z,{sx:{position:"relative",overflow:"unset"},children:(0,ee.jsx)(z.Z,{children:(0,ee.jsxs)(Z.Z,{size:$.dense?"small":"medium",sx:{minWidth:800},children:[(0,ee.jsx)(M.K,{order:$.order,orderBy:$.orderBy,headLabel:nn,rowCount:pe.length,numSelected:$.selected.length,onSort:$.onSort,onSelectAllRows:function(e){return $.onSelectAllRows(e,pe.map((function(e){return e.id})))}}),(0,ee.jsxs)(y.Z,{children:[Ke.slice($.page*$.rowsPerPage,$.page*$.rowsPerPage+$.rowsPerPage).map((function(e){return(0,ee.jsx)(xe,{row:e,salesStatus:t,selected:$.selected.includes(e.id),onSelectRow:function(){return $.onSelectRow(e.id)},onViewRow:function(){return cn(e.id)},onEditRow:function(){return an(e.id)},onDeleteRow:function(){return on(e.id)},handleOpen:function(e){return function(e){ze(e),Ne(!0)}(e)},handleConfirmAndReject:function(e,n){return dn(e,n)}},e.id)})),(0,ee.jsx)(M.$W,{height:Xe,emptyRows:(0,M.fQ)($.page,$.rowsPerPage,pe.length)}),(0,ee.jsx)(M.et,{notFound:en})]})]})})}),(0,ee.jsx)(M.S_,{count:Ke.length,page:$.page,rowsPerPage:$.rowsPerPage,onPageChange:$.onChangePage,onRowsPerPageChange:$.onChangeRowsPerPage,dense:$.dense,onChangeDense:$.onChangeDense})]}),(0,ee.jsx)(x.Z,{sx:{width:"50%",flex:1,marginLeft:"auto",marginTop:"10px"},children:(0,ee.jsx)(I.Z,{in:Te,children:(0,ee.jsx)(w.Z,{severity:"Success"===Qe?"success":"error",action:(0,ee.jsx)(C.Z,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){He(!1)},children:(0,ee.jsx)(R.JO,{icon:"ic:round-close"})}),sx:{mb:2},children:Qe})})})]}),(0,ee.jsx)(B.Q,{open:X.value,onClose:X.onFalse,title:oe("Delete"),content:(0,ee.jsxs)(ee.Fragment,{children:["Are you sure want to delete ",(0,ee.jsxs)("strong",{children:[" ",$.selected.length," "]})," items?"]}),action:(0,ee.jsx)(g.Z,{variant:"contained",color:"error",onClick:function(){sn(),X.onFalse()},children:oe("Delete")})}),(0,ee.jsxs)(N.Z,{open:Ie,color:"#ef5350",keepMounted:!0,onClose:$e,children:[(0,ee.jsx)(F.Z,{children:oe("assignUser")}),(0,ee.jsx)(A.Z,{children:(0,ee.jsx)(P.Z,{value:Fe,onChange:function(e){console.log(e.target.value),Oe(e.target.value)},input:(0,ee.jsx)(D.Z,{label:""}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:ce.map((function(e){return(0,ee.jsx)(S.Z,{value:e.username,children:e.username},e.id)}))})}),(0,ee.jsxs)(E.Z,{children:[(0,ee.jsx)(g.Z,{onClick:$e,children:oe("close")}),(0,ee.jsx)(g.Z,{onClick:pn,children:oe("save")})]})]})]})}function be(e){var n=e.id,t=e.salesStatus;console.log(n);var o=n?(0,ee.jsx)(we,{department:n}):(0,ee.jsx)(we,{salesStatus:t});return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(r.ql,{children:(0,ee.jsx)("title",{children:" Dashboard: Invoice List"})}),o]})}},49088:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(69931),o=t(12065),s=t(64554),i=t(36314),a=t(4567),c=t(13239),l=t(17070),u=t(27216),d=t(80184);function p(e){var n,t=e.title,p=e.total,h=e.icon,f=e.color,x=e.percent,m=e.price,Z=(0,r.nt)().t;return(0,d.jsxs)(i.Z,{spacing:2.5,direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:200},children:[(0,d.jsxs)(i.Z,{alignItems:"center",justifyContent:"center",sx:{position:"relative"},children:[(0,d.jsx)(u.Z,{icon:h,width:32,sx:{color:f,position:"absolute"}}),(0,d.jsx)(c.Z,{variant:"determinate",value:x,size:56,thickness:2,sx:{color:f,opacity:.48}}),(0,d.jsx)(c.Z,{variant:"determinate",value:100,size:56,thickness:3,sx:{top:0,left:0,opacity:.48,position:"absolute",color:function(e){return(0,o.Fq)(e.palette.grey[500],.16)}}})]}),(0,d.jsxs)(i.Z,{spacing:.5,children:[(0,d.jsx)(a.Z,{variant:"subtitle1",children:t}),(0,d.jsxs)(s.Z,{component:"span",sx:{color:"text.disabled",typography:"body2"},children:[(0,l.v1)(p)," ",(n="invoices",Z(n))]}),(0,d.jsx)(a.Z,{variant:"subtitle2",children:(0,l.e_)(m)})]})]})}},11276:function(e,n,t){t.d(n,{p:function(){return i}});var r=t(4942),o=(t(72791),t(25415)),s=t.n(o),i=function(e,n,t,r,o){console.log(e);var i=[];"invoicebydepartments"===r.toLowerCase()?i=a(e,n,t):"allinvoices"===r.toLowerCase()&&(i=c(e,n,t)),console.log("Headers: ",n),console.log("filteredData: ",i);var l=new(s().Workbook),u=l.addWorksheet("Sheet1"),d=u.addRow(n);i.forEach((function(e){var t=n.map((function(n){return e[n]}));u.addRow(t)})),u.columns.forEach((function(e){e.width=19,e.eachCell((function(e){e.font={name:"Arial",size:10,family:4,bold:!1,italic:!1},e.alignment={vertical:"middle",horizontal:"left",wrapText:!1}}))})),d.font={name:"Arial",bold:!0,size:10,color:{argb:"FF000000"}},console.log("Rows count: ",u.rowCount),l.xlsx.writeBuffer().then((function(e){var n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a");t.href=window.URL.createObjectURL(n),t.download="".concat(o,".xlsx"),t.click()}))},a=function(e,n,t){return e.map((function(e){var o;return o={},(0,r.Z)(o,n[0],e.invoiceNo),(0,r.Z)(o,n[1],"ar"===t?e.customerNameAr:e.customerNameEn),(0,r.Z)(o,n[2],e.issueInvoiceDate),(0,r.Z)(o,n[3],e.invoiceAmount),(0,r.Z)(o,n[4],e.region),(0,r.Z)(o,n[5],"ar"===t?e.productNameAr:e.productNameEn),o}))},c=function(e,n,t){return e.map((function(e){var o;return o={},(0,r.Z)(o,n[0],e.invoiceNo),(0,r.Z)(o,n[1],"ar"===t?e.customerNameAr:e.customerNameEn),(0,r.Z)(o,n[2],e.issueInvoiceDate),(0,r.Z)(o,n[3],e.daysToCollected),(0,r.Z)(o,n[4],e.invoiceAmount),(0,r.Z)(o,n[5],e.paidStatus),(0,r.Z)(o,n[6],e.department),o}))}},17070:function(e,n,t){t.d(n,{FK:function(){return s},e_:function(){return i},f2:function(){return a},oe:function(){return l},v1:function(){return c}});var r=t(26098),o=t.n(r);function s(e){return o()(e).format()}function i(e){return u(e?o()(e).format("SAR0,0.00"):"",".00")}function a(e){return u(e?o()(Number(e)/100).format("0.0%"):"",".0")}function c(e){return u(e?o()(e).format("0.00a"):"",".00")}function l(e){return u(e?o()(e).format("0.0 b"):"",".0")}function u(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".00";return e.includes(n)?e.replace(n,""):e}}}]);
//# sourceMappingURL=3111.f0f7481d.chunk.js.map