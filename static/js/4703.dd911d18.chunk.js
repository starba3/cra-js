"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[4703],{64703:function(e,n,t){t.r(n),t.d(n,{default:function(){return ke}});var r=t(6907),i=t(4942),o=t(1413),s=t(74165),a=t(15861),l=t(29439),c=t(72791),u=t(31357),d=t.n(u),p=t(69931),h=t(13967),x=t(4567),f=t(57621),m=t(79836),Z=t(36314),j=t(5849),g=t(94721),v=t(89164),b=t(53382),w=t(13400),y=t(39281),C=t(56890),k=t(9195),D=t(68745),S=t(48550),P=t(5574),I=t(97123),R=t(39157),F=t(65661),A=t(63515),O=t(62711),E=t(56125),N=t(13239),W=t(38072),T=t(19208),L=t(83854),z=t(22459),q=t(9145),B=t(27216),_=t(47974),M=t(3352),V=t(60720),H=t(50933),U=t(1382),Q=t(91617),K=t(41557),G=t(62633),$=t(11276),J=t(49088),X=t(45987),Y=t(64554),ee=t(85771),ne=t(27938),te=t(25265),re=t(80184),ie=["filters","onFilters","onResetFilters","results"],oe=["label","children","sx"];function se(e){var n=e.filters,t=e.onFilters,r=e.onResetFilters,i=e.results,s=(0,X.Z)(e,ie),a=(0,te.l2)(n.startDate,n.endDate);return(0,re.jsxs)(Z.Z,(0,o.Z)((0,o.Z)({spacing:1.5},s),{},{children:[(0,re.jsxs)(Y.Z,{sx:{typography:"body2"},children:[(0,re.jsx)("strong",{children:i}),(0,re.jsx)(Y.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),(0,re.jsxs)(Z.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[!!n.departments.length&&(0,re.jsx)(ae,{label:"Departments:",children:n.departments.map((function(e){return(0,re.jsx)(ee.Z,{label:e,size:"small",onDelete:function(){return function(e){var r=n.departments.filter((function(n){return n!==e}));t("departments",r)}(e)}},e)}))}),"all"!==n.status&&(0,re.jsx)(ae,{label:"Status:",children:(0,re.jsx)(ee.Z,{size:"small",label:n.status,onDelete:function(){t("status","all")}})}),n.startDate&&n.endDate&&(0,re.jsx)(ae,{label:"Date:",children:(0,re.jsx)(ee.Z,{size:"small",label:a,onDelete:function(){t("startDate",null),t("endDate",null)}})}),(0,re.jsx)(j.Z,{color:"error",onClick:r,startIcon:(0,re.jsx)(B.Z,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]}))}function ae(e){var n=e.label,t=e.children,r=e.sx,i=(0,X.Z)(e,oe);return(0,re.jsxs)(Z.Z,(0,o.Z)((0,o.Z)({component:ne.Z,variant:"outlined",spacing:1,direction:"row",sx:(0,o.Z)({p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed"},r)},i),{},{children:[(0,re.jsx)(Y.Z,{component:"span",sx:{typography:"subtitle2"},children:n}),(0,re.jsx)(Z.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:t})]}))}var le=t(16386),ce=t(50533),ue=t(60220),de=t(82626),pe=t(13034),he=t(49900),xe=t(52115);function fe(e){var n=e.row,t=e.selected,r=e.onSelectRow,i=e.onViewRow,o=(e.onEditRow,e.onDeleteRow),s=e.handleOpenInquiry,a=(n.id,n.invoiceNo),l=n.issueInvoiceDate,c=n.invoiceAmount,u=n.daysToCollected,d=n.customerNameAr,h=n.customerNameEn,f=n.paidStatus,m=n.department,Z=(0,p.nt)(),v=Z.t,b="ar"===Z.currentLang.value?d:h,y=function(e){return v(e)},C=(0,z.k)(),S=(0,xe.S)();return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(k.Z,{hover:!0,selected:t,children:[(0,re.jsx)(D.Z,{padding:"checkbox",children:(0,re.jsx)(pe.Z,{checked:t,onClick:r})}),(0,re.jsxs)(D.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,re.jsx)(ue.Z,{alt:b,sx:{mr:2},children:b.charAt(0).toUpperCase()}),(0,re.jsx)(he.Z,{disableTypography:!0,primary:(0,re.jsx)(x.Z,{variant:"body2",noWrap:!0,children:b}),secondary:(0,re.jsx)(ce.Z,{noWrap:!0,variant:"body2",onClick:i,sx:{color:"text.disabled",cursor:"pointer"},children:a})})]}),(0,re.jsx)(D.Z,{children:(0,re.jsx)(he.Z,{primary:(0,le.Z)(new Date(l),"dd MMM yyyy"),secondary:(0,le.Z)(new Date(l),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),(0,re.jsx)(D.Z,{children:u}),(0,re.jsx)(D.Z,{children:"".concat(c," ").concat(y("currencyShortcut"))}),(0,re.jsx)(D.Z,{align:"center",children:f}),(0,re.jsx)(D.Z,{align:"center",children:m}),(0,re.jsx)(D.Z,{align:"right",sx:{px:1},children:(0,re.jsx)(w.Z,{color:S.open?"inherit":"default",onClick:S.onOpen,children:(0,re.jsx)(B.Z,{icon:"eva:more-vertical-fill"})})})]}),(0,re.jsxs)(xe.Z,{open:S.open,onClose:S.onClose,arrow:"right-top",sx:{width:160},children:[(0,re.jsxs)(de.Z,{onClick:function(){i(),S.onClose()},children:[(0,re.jsx)(B.Z,{icon:"solar:eye-bold"}),y("view")]}),(0,re.jsxs)(de.Z,{onClick:function(){s(),S.onClose()},children:[(0,re.jsx)(B.Z,{icon:"bx:file"}),y("inquiry")]}),(0,re.jsx)(g.Z,{sx:{borderStyle:"solid"}}),(0,re.jsxs)(de.Z,{onClick:function(){C.onTrue(),S.onClose()},sx:{color:"error.main"},children:[(0,re.jsx)(B.Z,{icon:"solar:trash-bin-trash-bold"}),y("delete")]})]}),(0,re.jsx)(M.Q,{open:C.value,onClose:C.onFalse,title:y("delete"),content:y("deleteComfirmationMessage"),action:(0,re.jsx)(j.Z,{variant:"contained",color:"error",onClick:function(){console.log("Delete clicked"),o(),C.onFalse()},children:y("delete")})})]})}var me=t(53106),Ze=t(62861),je=t(68096),ge=t(63466),ve=t(77196),be=t(58406);function we(e){var n=e.filters,t=e.onFilters,r=e.dateError,i=e.serviceOptions,o=e.paidStatusOptions,s=(0,xe.S)(),a=(0,c.useRef)([]),l=(0,c.useRef)([]),u=(0,p.nt)().t,d=function(e){return u(e)},h=(0,c.useCallback)((function(e){t("name",e.target.value)}),[t]),x=(0,c.useCallback)((function(e){t("departments","string"===typeof e?e.split(","):e)}),[t]),f=(0,c.useCallback)((function(e){t("paidStatus","string"===typeof e?e.split(","):e)}),[t]),m=(0,c.useCallback)((function(e){t("startDate",e)}),[t]),j=(0,c.useCallback)((function(e){t("endDate",e)}),[t]);return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(Z.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,re.jsxs)(je.Z,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[(0,re.jsx)(Ze.Z,{children:d("departments")}),(0,re.jsx)(be.Z,{multiple:!0,value:n.departments,onChange:function(e){var n=i,t=e.target.value,r=t.length-1;console.log(t),"All"===t[r]?(x(n),l.current=n):"All"===t[0]?(x(t.slice(1)),l.current=t.slice(1)):l.current.length&&"All"===l.current.slice()[0]?(x([]),l.current=[]):(x(t),l.current=t)},input:(0,re.jsx)(ve.Z,{label:d("departments")}),renderValue:function(e){return e.map((function(e){return e})).join(", ")},sx:{textTransform:"capitalize"},children:i.map((function(e){return(0,re.jsxs)(de.Z,{value:e,children:[(0,re.jsx)(pe.Z,{disableRipple:!0,size:"small",checked:n.departments.includes(e)}),e]},e)}))})]}),(0,re.jsxs)(je.Z,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[(0,re.jsx)(Ze.Z,{children:d("paidStatus")}),(0,re.jsx)(be.Z,{multiple:!0,value:n.paidStatus,onChange:function(e){var n=o,t=e.target.value,r=t.length-1;console.log(t),"All"===t[r]?(f(n),a.current=n):"All"===t[0]?(f(t.slice(1)),a.current=t.slice(1)):a.current.length&&"All"===a.current.slice()[0]?(f([]),a.current=[]):(f(t),a.current=t)},input:(0,re.jsx)(ve.Z,{label:d("paidStatus")}),renderValue:function(e){return e.map((function(e){return e})).join(", ")},sx:{textTransform:"capitalize"},children:o.map((function(e){return(0,re.jsxs)(de.Z,{value:e,children:[(0,re.jsx)(pe.Z,{disableRipple:!0,size:"small",checked:n.paidStatus.includes(e)}),e]},e)}))})]}),(0,re.jsx)(me.M,{label:d("startDate"),value:n.startDate,onChange:m,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:180}}}),(0,re.jsx)(me.M,{label:d("endDate"),value:n.endDate,onChange:j,slotProps:{textField:{fullWidth:!0,error:r}},sx:{maxWidth:{md:180}}}),(0,re.jsx)(Z.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:(0,re.jsx)(S.Z,{fullWidth:!0,value:n.name,onChange:h,placeholder:d("searchInvoiceNamePlaceHolder"),InputProps:{startAdornment:(0,re.jsx)(ge.Z,{position:"start",children:(0,re.jsx)(B.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]}),(0,re.jsxs)(xe.Z,{open:s.open,onClose:s.onClose,arrow:"right-top",sx:{width:140},children:[(0,re.jsxs)(de.Z,{onClick:function(){s.onClose()},children:[(0,re.jsx)(B.Z,{icon:"solar:printer-minimalistic-bold"}),d("print")]}),(0,re.jsxs)(de.Z,{onClick:function(){s.onClose()},children:[(0,re.jsx)(B.Z,{icon:"solar:import-bold"}),d("import")]}),(0,re.jsxs)(de.Z,{onClick:function(){s.onClose()},children:[(0,re.jsx)(B.Z,{icon:"solar:export-bold"}),d("export")]})]})]})}var ye={name:"",departments:[],paidStatus:[],status:"all",startDate:null,endDate:null};function Ce(){var e=(0,h.Z)(),n=(0,V.K$)(),t=(0,T.tv)(),r=(0,U.x6)({defaultOrderBy:"issueInvoiceDate"}),u=(0,z.k)(),X=(0,p.nt)(),Y=X.t,ee=X.currentLang,ne=function(e){return Y(e)},te=(0,c.useState)([]),ie=(0,l.Z)(te,2),oe=ie[0],ae=ie[1],le=(0,c.useState)(!1),ce=(0,l.Z)(le,2),ue=ce[0],de=ce[1],pe=(0,c.useState)(ye),he=(0,l.Z)(pe,2),xe=he[0],me=he[1],Ze=c.useState(!1),je=(0,l.Z)(Ze,2),ge=je[0],ve=je[1],be=(0,c.useState)(!1),Ce=(0,l.Z)(be,2),ke=(Ce[0],Ce[1],(0,c.useState)([""])),De=(0,l.Z)(ke,2),Se=(De[0],De[1],(0,c.useState)(!1)),Pe=(0,l.Z)(Se,2),Ie=Pe[0],Re=Pe[1],Fe=(0,c.useState)(!1),Ae=(0,l.Z)(Fe,2),Oe=Ae[0],Ee=Ae[1],Ne=(0,c.useState)(""),We=(0,l.Z)(Ne,2),Te=We[0],Le=We[1],ze=(0,c.useState)(!1),qe=(0,l.Z)(ze,2),Be=qe[0],_e=qe[1],Me=(0,c.useState)(!1),Ve=(0,l.Z)(Me,2),He=Ve[0],Ue=Ve[1],Qe=(0,c.useState)(0),Ke=(0,l.Z)(Qe,2),Ge=Ke[0],$e=Ke[1],Je=(0,c.useState)({}),Xe=(0,l.Z)(Je,2),Ye=Xe[0],en=Xe[1];(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Q.qL)();case 3:n=e.sent,ae(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching invoices:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[ue]),(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Ge){e.next=8;break}return e.next=4,(0,Q.DW)(Ge);case 4:n=e.sent,en(n),e.next=9;break;case 8:en({});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching invoices:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();e()}),[Ge]);var nn=!(!xe.startDate||!xe.endDate)&&xe.startDate.getTime()>xe.endDate.getTime(),tn=function(e){var n=e.inputData,t=e.comparator,r=e.filters,i=e.dateError,o=r.name,s=r.status,a=r.departments,l=r.startDate,c=r.paidStatus,u=r.endDate,d=n.map((function(e,n){return[e,n]}));d.sort((function(e,n){var r=t(e[0],n[0]);return 0!==r?r:e[1]-n[1]})),n=d.map((function(e){return e[0]})),o&&(n=n.filter((function(e){return-1!==e.customerNameEn.toLowerCase().indexOf(o.toLowerCase())||-1!==e.invoiceNo.toLowerCase().indexOf(o.toLowerCase())})));"all"!==s&&(n=n.filter((function(e){return e.status===s})));a.length&&(n=n.filter((function(e){return a.includes("All")||a.includes(e.department)})));c.length&&(n=n.filter((function(e){return c.includes("All")||c.map((function(e){return e.toLowerCase()})).includes(e.paidStatus)})));i||l&&u&&(n=n.filter((function(e){return(0,q.IO)(e.issueInvoiceDate)>=(0,q.IO)(l)&&(0,q.IO)(e.issueInvoiceDate)<=(0,q.IO)(u)})));return n}({inputData:oe,comparator:(0,U.sQ)(r.order,r.orderBy),filters:xe,dateError:nn}),rn=tn.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage),on=r.dense?56:76,sn=!!xe.name||!!xe.departments.length||"all"!==xe.status||!!xe.startDate&&!!xe.endDate,an=[{id:"invoiceNumber",label:ne("invoiceNumber")},{id:"issueInvoiceDate",label:ne("issueInvoiceDate")},{id:"daysToCollected",label:ne("daysToCollected")},{id:"invoiceAmount",label:ne("invoiceAmount")},{id:"paidStatus",label:ne("paidStatus"),align:"center"},{id:"department",label:ne("department"),align:"center"},{id:""}],ln=[ne("invoiceNumber"),ne("customerName"),ne("issueInvoiceDate"),ne("daysToCollected"),ne("invoiceAmount"),ne("paidStatus"),ne("department")],cn=!tn.length&&sn||!tn.length,un=function(e){return oe.filter((function(n){return n.paidStatus===e})).length},dn=function(e){return d()(oe.filter((function(n){return n.paidStatus===e})),"invoiceAmount")},pn=function(e){return un(e)/oe.length*100},hn=(0,c.useCallback)((function(e,n){r.onResetPage(),me((function(t){return(0,o.Z)((0,o.Z)({},t),{},(0,i.Z)({},e,n))}))}),[r]),xn=(0,c.useCallback)((function(){var e=oe.filter((function(e){return!r.selected.includes(e.id)}));ae(e),r.onUpdatePageDeleteRows({totalRows:oe.length,totalRowsInPage:rn.length,totalRowsFiltered:tn.length})}),[tn.length,rn.length,r,oe]),fn=(0,c.useCallback)((function(e){t.push(W.H.dashboard.invoice.edit(e))}),[t]),mn=(0,c.useCallback)((function(e){t.push(W.H.dashboard.invoice.details(e))}),[t]),Zn=((0,c.useCallback)((function(e,n){hn("paidStatus",n)}),[hn]),(0,c.useCallback)((function(){me(ye)}),[])),jn=function(){ve(!1),Ee(!1)};return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(v.Z,{maxWidth:!n.themeStretch&&"lg",children:[(0,re.jsx)(H.Z,{heading:ne("list"),links:[{name:ne("app"),href:W.H.dashboard.root},{name:ne("invoice")},{name:ne("list")}],action:(0,re.jsxs)(Z.Z,{direction:"row",divider:(0,re.jsx)(g.Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[(0,re.jsx)(j.Z,{component:L.r,href:W.H.dashboard.invoice.new,variant:"contained",startIcon:(0,re.jsx)(B.Z,{icon:"mingcute:add-line"}),children:ne("newInvoice")}),(0,re.jsx)(j.Z,{component:L.r,variant:"contained",color:"primary",onClick:function(){ve(!0)},startIcon:(0,re.jsx)(B.Z,{icon:"solar:import-bold"}),children:ne("import")}),(0,re.jsx)(j.Z,{variant:"contained",color:"primary",onClick:function(){return(0,$.p)(oe,ln,ee.value,"AllInvoices","ExportFile-".concat(new Date))},startIcon:(0,re.jsx)(B.Z,{icon:"eva:download-outline"}),children:ne("export")})]}),sx:{mb:{xs:3,md:5}}}),(0,re.jsx)(f.Z,{sx:{mb:{xs:3,md:5}},children:(0,re.jsx)(_.Z,{children:(0,re.jsxs)(Z.Z,{direction:"row",divider:(0,re.jsx)(g.Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[(0,re.jsx)(J.Z,{title:ne("total"),total:oe.length,percent:100,price:d()(oe,"invoiceAmount"),icon:"solar:bill-list-bold-duotone",color:e.palette.info.main}),(0,re.jsx)(J.Z,{title:ne("paid"),total:un("paid"),percent:pn("paid"),price:dn("paid"),icon:"solar:file-check-bold-duotone",color:e.palette.success.main}),(0,re.jsx)(J.Z,{title:ne("unpaid"),total:un("unpaid"),percent:pn("unpaid"),price:dn("unpaid"),icon:"solar:sort-by-time-bold-duotone",color:e.palette.warning.main})]})})}),(0,re.jsxs)(f.Z,{children:[(0,re.jsx)(we,{filters:xe,onFilters:hn,dateError:nn,serviceOptions:(0,K.b)().map((function(e){return e})),paidStatusOptions:(0,G.O)().map((function(e){return e}))}),sn&&(0,re.jsx)(se,{filters:xe,onFilters:hn,onResetFilters:Zn,results:tn.length,sx:{p:2.5,pt:0}}),(0,re.jsx)(y.Z,{sx:{position:"relative",overflow:"unset"},children:(0,re.jsx)(_.Z,{children:(0,re.jsxs)(m.Z,{size:r.dense?"small":"medium",sx:{minWidth:800},children:[(0,re.jsx)(U.K,{order:r.order,orderBy:r.orderBy,headLabel:an,rowCount:oe.length,numSelected:r.selected.length,onSort:r.onSort,onSelectAllRows:function(e){return r.onSelectAllRows(e,oe.map((function(e){return e.id})))}}),(0,re.jsxs)(b.Z,{children:[tn.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage).map((function(e){return(0,re.jsx)(fe,{row:e,selected:r.selected.includes(e.id),onSelectRow:function(){return r.onSelectRow(e.id)},onViewRow:function(){return mn(e.id)},onEditRow:function(){return fn(e.id)},onDeleteRow:function(){return function(e){var n=!0,t=function(){var t=(0,a.Z)((0,s.Z)().mark((function t(){var r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,Q.Wu)(e);case 3:n=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error fetching invoices:",t.t0);case 9:if(console.log("Success status: ",n),!n){t.next=22;break}return t.prev=11,t.next=14,(0,Q.qL)();case 14:r=t.sent,ae(r),t.next=21;break;case 18:t.prev=18,t.t1=t.catch(11),console.error("Error fetching invoices:",t.t1);case 21:de(!ue);case 22:case"end":return t.stop()}}),t,null,[[0,6],[11,18]])})));return function(){return t.apply(this,arguments)}}();t()}(e.id)},handleOpenInquiry:function(){return n=e.id,$e(n),void Ue(!0);var n}},e.id)})),(0,re.jsx)(U.$W,{height:on,emptyRows:(0,U.fQ)(r.page,r.rowsPerPage,oe.length)}),(0,re.jsx)(U.et,{notFound:cn})]})]})})}),(0,re.jsx)(U.S_,{count:tn.length,page:r.page,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onRowsPerPageChange:r.onChangeRowsPerPage,dense:r.dense,onChangeDense:r.onChangeDense})]})]}),(0,re.jsx)(M.Q,{open:u.value,onClose:u.onFalse,title:ne("delete"),content:(0,re.jsxs)(re.Fragment,{children:["Are you sure want to delete ",(0,re.jsxs)("strong",{children:[" ",r.selected.length," "]})," items?"]}),action:(0,re.jsx)(j.Z,{variant:"contained",color:"error",onClick:function(){xn(),u.onFalse()},children:"Delete"})}),(0,re.jsxs)(P.Z,{open:ge,onClose:jn,children:[(0,re.jsx)(F.Z,{children:"File upload"}),(0,re.jsxs)(R.Z,{children:[(0,re.jsx)(S.Z,{autoFocus:!0,required:!0,margin:"dense",id:"file",label:ne("importFile"),type:"file",fullWidth:!0,variant:"standard",inputProps:{accept:".xls, .xlsx"}}),(0,re.jsx)(E.Z,{in:Oe,children:(0,re.jsx)(A.Z,{severity:Ie?"error":"success",action:(0,re.jsx)(w.Z,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){Ee(!1)},children:(0,re.jsx)(O.JO,{icon:"ic:baseline-close"})}),sx:{mb:2},children:Te})}),Be&&(0,re.jsx)(N.Z,{})]}),(0,re.jsxs)(I.Z,{children:[(0,re.jsx)(j.Z,{onClick:jn,children:ne("cancel")}),(0,re.jsx)(j.Z,{onClick:function(){console.log("Loading:",Be);var e=new FormData,n=document.querySelector("#file").files[0];if(n){_e(!0),e.append("file",n);try{console.log("Loading",Be);var t=(0,Q.OX)();console.log("Url",t),fetch(t,{mode:"cors",method:"POST",headers:{Accept:"application/json"},body:e,Cache:"default"}).then(function(){var e=(0,a.Z)((0,s.Z)().mark((function e(n){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,3e3)}));case 2:if(n.ok){e.next=9;break}if(400!==n.status&&415!==n.status){e.next=8;break}return e.next=6,n.text();case 6:throw t=e.sent,new Error("Bad Request: ".concat(t));case 8:throw new Error("Network response was not ok");case 9:return e.abrupt("return",n.text());case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).then((function(e){Re(!1),Le(e)})).catch((function(e){console.error("Fetch Error:",e),Le("Invalid Data, check the file and try again"),Re(!0)}))}catch(r){}finally{_e(!1)}}else Re(!0),Le("No file selecetd.");Ee(!0)},children:ne("import")})]})]}),(0,re.jsxs)(P.Z,{open:He,maxWidth:!1,color:"#ef5350",keepMounted:!0,onClose:jn,children:[(0,re.jsx)(F.Z,{children:ne("invoiceInquiry")}),(0,re.jsxs)(R.Z,{children:[(0,re.jsxs)(Z.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,re.jsx)(x.Z,{children:ne("invoiceNumber")}),(0,re.jsx)(x.Z,{children:ne("createdBy")}),(0,re.jsx)(x.Z,{children:ne("creationDate")})]}),Object.prototype.hasOwnProperty.call(Ye,"invoiceData")&&(0,re.jsxs)(Z.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,re.jsx)(x.Z,{children:Ye.invoiceData.invoiceNO}),(0,re.jsx)(x.Z,{children:Ye.invoiceData.createdBy}),(0,re.jsx)(x.Z,{children:Ye.invoiceData.createdDate.substring(0,Ye.invoiceData.createdDate.indexOf("T"))})]}),(0,re.jsxs)(y.Z,{sx:{position:"relative",overflow:"unset"},children:[(0,re.jsx)(C.Z,{children:(0,re.jsxs)(k.Z,{children:[(0,re.jsx)(D.Z,{children:ne("property")}),(0,re.jsx)(D.Z,{align:"right",children:ne("oldValue")}),(0,re.jsx)(D.Z,{align:"right",children:ne("newValue")}),(0,re.jsx)(D.Z,{align:"right",children:ne("lastUpdated")}),(0,re.jsx)(D.Z,{align:"right",children:ne("updatedBy")})]})}),(0,re.jsx)(b.Z,{children:Object.prototype.hasOwnProperty.call(Ye,"logs")&&Ye.logs.map((function(e){return(0,re.jsxs)(k.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,re.jsx)(D.Z,{component:"th",scope:"row",children:e.propertyName}),(0,re.jsx)(D.Z,{align:"right",children:e.oldValue}),(0,re.jsx)(D.Z,{align:"right",children:e.newValue}),(0,re.jsx)(D.Z,{align:"right",children:e.dateModified.substring(0,e.dateModified.indexOf("T"))}),(0,re.jsx)(D.Z,{align:"right",children:e.modifiedBy})]},e.name)}))})]})]}),(0,re.jsx)(I.Z,{children:(0,re.jsx)(j.Z,{onClick:function(){return Ue(!1)},children:ne("close")})})]})]})}function ke(){return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(r.ql,{children:(0,re.jsx)("title",{children:" Dashboard: Invoice List"})}),(0,re.jsx)(Ce,{})]})}},49088:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(69931),i=t(12065),o=t(64554),s=t(36314),a=t(4567),l=t(13239),c=t(17070),u=t(27216),d=t(80184);function p(e){var n=e.title,t=e.total,p=e.icon,h=e.color,x=e.percent,f=e.price,m=(0,r.nt)().t,Z=function(e){return m(e)};return(0,d.jsxs)(s.Z,{spacing:2.5,direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:200},children:[(0,d.jsxs)(s.Z,{alignItems:"center",justifyContent:"center",sx:{position:"relative"},children:[(0,d.jsx)(u.Z,{icon:p,width:32,sx:{color:h,position:"absolute"}}),(0,d.jsx)(l.Z,{variant:"determinate",value:x,size:56,thickness:2,sx:{color:h,opacity:.48}}),(0,d.jsx)(l.Z,{variant:"determinate",value:100,size:56,thickness:3,sx:{top:0,left:0,opacity:.48,position:"absolute",color:function(e){return(0,i.Fq)(e.palette.grey[500],.16)}}})]}),(0,d.jsxs)(s.Z,{spacing:.5,children:[(0,d.jsx)(a.Z,{variant:"subtitle1",children:n}),(0,d.jsxs)(o.Z,{component:"span",sx:{color:"text.disabled",typography:"body2"},children:[(0,c.v1)(t)," ",Z("invoices")]}),(0,d.jsx)(a.Z,{variant:"subtitle2",children:"".concat(f," ").concat(Z("currencyShortcut"))})]})]})}},11276:function(e,n,t){t.d(n,{p:function(){return s}});var r=t(4942),i=(t(72791),t(25415)),o=t.n(i),s=function(e,n,t,r,i){console.log(e);var s=[];"invoicebydepartments"===r.toLowerCase()?s=a(e,n,t):"allinvoices"===r.toLowerCase()&&(s=l(e,n,t)),console.log("Headers: ",n),console.log("filteredData: ",s);var c=new(o().Workbook),u=c.addWorksheet("Sheet1"),d=u.addRow(n);s.forEach((function(e){var t=n.map((function(n){return e[n]}));u.addRow(t)})),u.columns.forEach((function(e){e.width=19,e.eachCell((function(e){e.font={name:"Arial",size:10,family:4,bold:!1,italic:!1},e.alignment={vertical:"middle",horizontal:"left",wrapText:!1}}))})),d.font={name:"Arial",bold:!0,size:10,color:{argb:"FF000000"}},console.log("Rows count: ",u.rowCount),c.xlsx.writeBuffer().then((function(e){var n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a");t.href=window.URL.createObjectURL(n),t.download="".concat(i,".xlsx"),t.click()}))},a=function(e,n,t){return e.map((function(e){var i;return i={},(0,r.Z)(i,n[0],e.invoiceNo),(0,r.Z)(i,n[1],"ar"===t?e.customerNameAr:e.customerNameEn),(0,r.Z)(i,n[2],e.issueInvoiceDate),(0,r.Z)(i,n[3],e.invoiceAmount),(0,r.Z)(i,n[4],e.region),(0,r.Z)(i,n[5],"ar"===t?e.productNameAr:e.productNameEn),i}))},l=function(e,n,t){return e.map((function(e){var i;return i={},(0,r.Z)(i,n[0],e.invoiceNo),(0,r.Z)(i,n[1],"ar"===t?e.customerNameAr:e.customerNameEn),(0,r.Z)(i,n[2],e.issueInvoiceDate),(0,r.Z)(i,n[3],e.daysToCollected),(0,r.Z)(i,n[4],e.invoiceAmount),(0,r.Z)(i,n[5],e.paidStatus),(0,r.Z)(i,n[6],e.department),i}))}},17070:function(e,n,t){t.d(n,{FK:function(){return o},e_:function(){return s},f2:function(){return a},oe:function(){return c},v1:function(){return l}});var r=t(26098),i=t.n(r);function o(e){return i()(e).format()}function s(e){return u(e?i()(e).format("SAR0,0.00"):"",".00")}function a(e){return u(e?i()(Number(e)/100).format("0.0%"):"",".0")}function l(e){return u(e?i()(e).format("0.00a"):"",".00")}function c(e){return u(e?i()(e).format("0.0 b"):"",".0")}function u(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".00";return e.includes(n)?e.replace(n,""):e}}}]);
//# sourceMappingURL=4703.dd911d18.chunk.js.map