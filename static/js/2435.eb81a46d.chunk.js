"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[2435],{50933:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(1413),a=n(45987),i=n(64554),o=n(50533),l=n(36314),s=n(4567),c=n(93517),u=n(83854),d=n(80184);function p(e){var t=e.link,n=e.activeLast,a=e.disabled,l=t.name,s=t.href,c=t.icon,p=(0,r.Z)({typography:"body2",alignItems:"center",color:"text.primary",display:"inline-flex"},a&&!n&&{cursor:"default",pointerEvents:"none",color:"text.disabled"}),f=(0,d.jsxs)(d.Fragment,{children:[c&&(0,d.jsx)(i.Z,{component:"span",sx:{mr:1,display:"inherit","& svg":{width:20,height:20}},children:c}),l]});return s?(0,d.jsx)(o.Z,{component:u.r,href:s,sx:p,children:f}):(0,d.jsxs)(i.Z,{sx:p,children:[" ",f," "]})}var f=["links","action","heading","moreLink","activeLast","sx"];function h(e){var t=e.links,n=e.action,u=e.heading,h=e.moreLink,v=e.activeLast,m=e.sx,Z=(0,a.Z)(e,f),g=t[t.length-1].name;return(0,d.jsxs)(i.Z,{sx:(0,r.Z)({},m),children:[(0,d.jsxs)(l.Z,{direction:"row",alignItems:"center",children:[(0,d.jsxs)(i.Z,{sx:{flexGrow:1},children:[u&&(0,d.jsx)(s.Z,{variant:"h4",gutterBottom:!0,children:u}),!!t.length&&(0,d.jsx)(c.Z,(0,r.Z)((0,r.Z)({separator:(0,d.jsx)(x,{})},Z),{},{children:t.map((function(e){return(0,d.jsx)(p,{link:e,activeLast:v,disabled:e.name===g},e.name||"")}))}))]}),n&&(0,d.jsxs)(i.Z,{sx:{flexShrink:0},children:[" ",n," "]})]}),!!h&&(0,d.jsx)(i.Z,{sx:{mt:2},children:h.map((function(e){return(0,d.jsx)(o.Z,{href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)}))})]})}function x(){return(0,d.jsx)(i.Z,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})}},91617:function(e,t,n){n.d(t,{Ag:function(){return f},DW:function(){return y},ES:function(){return d},G_:function(){return g},OX:function(){return m},ZN:function(){return Z},iJ:function(){return v},kT:function(){return x},m3:function(){return S},qL:function(){return l},zJ:function(){return c}});var r=n(74165),a=n(15861),i=(n(763),n(38072)),o="https://invoicecollectionsystemapi.azurewebsites.net";function l(){return s.apply(this,arguments)}function s(){return(s=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("".concat(o,"/api/invoices"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){t=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,fetch("".concat(o,"/api/Invoices/Department/").concat(t),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],a="",a=t?"".concat(o,"/api/Invoices/GetInvoicesBySalesConfirmation?salesConfirm=").concat(t):"".concat(o,"/api/Invoices/NotConfirmedBySales"),e.next=5,fetch(a,{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/api/invoices/").concat(t),{mode:"cors"});case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:return a=e.sent,e.abrupt("return",a);case 9:console.error("Failed to fetch invoice: ".concat(n.status," - ").concat(n.statusText)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:return e.abrupt("return",{});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function x(e,t){var n="";switch(e){case-1:case 0:n="".concat(o,"/api/Invoices/").concat(t,"/Edit/Operation");break;case 1:n="".concat(o,"/api/Invoices/").concat(t,"/Edit/installation");break;case 2:n="".concat(o,"/api/Invoices/").concat(t,"/Edit/Sales");break;case 3:n="".concat(o,"/api/Invoices/").concat(t,"/Edit/Collection");break;case 4:n="".concat(o,"/api/Invoices/").concat(t,"/Edit/TenderAndContracts")}return n}function v(e){var t="";switch(e){case-1:case 0:t=i.H.departments.operation.list;break;case 1:t=i.H.departments.installation.list;break;case 2:t=i.H.departments.sales.list;break;case 3:t=i.H.departments.collection.list;break;case 4:t=i.H.departments.tenderAndConract.list}return t}function m(){return"".concat(o,"/api/ExcelImport/import-invoices")}function Z(e){return"".concat(o,"/api/Attachments/").concat(e)}function g(){return j.apply(this,arguments)}function j(){return(j=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("".concat(o,"/api/CollectionData"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){t=e})).catch((function(e){return console.log()}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},console.log("".concat(o,"/api/Invoices/").concat(t,"/Inquiry")),e.next=4,fetch("".concat(o,"/api/Invoices/").concat(t,"/Inquiry"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){return console.log()}));case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return w.apply(this,arguments)}function w(){return(w=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],t){e.next=3;break}return e.abrupt("return",n);case 3:return a=t.reduce((function(e,t){return"".concat(e,"customerIds=").concat(t,"&")}),""),e.next=6,fetch("".concat(o,"/api/Invoices/GetInvoicesForCustomers?").concat(a),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){n=e})).catch((function(e){console.log(e),n=[]}));case 6:return console.log("Result: ",n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},41557:function(e,t,n){n.d(t,{b:function(){return i},j:function(){return o}});var r=n(80831),a=function(e){return(0,(0,r.Z)().t)(e)},i=function(){return[a("All"),a("Operation"),a("Sales"),a("Installation"),a("Collection"),a("TenderAndContracts")]},o=function(){return[a("Operation"),a("Installation"),a("Sales"),a("Collection"),a("TenderAndContracts")]}},44557:function(e,t,n){n.r(t),n.d(t,{default:function(){return de}});var r=n(6907),a=n(19208),i=n(74165),o=n(15861),l=n(29439),s=n(72791),c=n(69931),u=n(89164),d=n(13239),p=n(38072),f=n(91617),h=n(60720),x=n(50933),v=n(4942),m=n(1413),Z=n(8007),g=n(61134),j=n(44695),y=n(12258),b=n(57621),S=n(36314),w=n(5849),C=n(5574),k=n(97123),D=n(39157),I=n(51691),T=n(65661),N=n(41557),L=n(22459),E=n(39231),A=n(94721),z=n(48550),F=n(63466),_=n(4567),O=n(38887),R=n(27216),H=n(80184);function P(e){e.currentInvoice;var t=(0,g.Gc)(),n=t.control,r=(t.watch,t.setValue,t.formState.errors,(0,O.F)("up","md")),a=(0,c.nt)().t,i=function(e){return a(e)};return(0,H.jsxs)(S.Z,{spacing:{xs:3,md:5},direction:{xs:"column",md:"row"},divider:(0,H.jsx)(A.Z,{flexItem:!0,orientation:r?"vertical":"horizontal",sx:{borderStyle:"dashed"}}),sx:{p:3},children:[(0,H.jsxs)(S.Z,{sx:{width:1},children:[(0,H.jsx)(S.Z,{direction:"row",alignItems:"center",sx:{mb:1},children:(0,H.jsxs)(_.Z,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:[i("attachment"),":"]})}),(0,H.jsx)(z.Z,{type:"file",id:"file",variant:"outlined",inputProps:{accept:".xls, .xlsx"}})]}),(0,H.jsxs)(S.Z,{sx:{width:1},children:[(0,H.jsx)(S.Z,{direction:"row",alignItems:"center",sx:{mb:1},children:(0,H.jsxs)(_.Z,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:[i("newNote"),":"]})}),(0,H.jsx)(g.Qr,{name:"CreateNote",control:n,render:function(e){var t=e.field;return(0,H.jsx)(z.Z,{fullWidth:!0,value:t.value,onChange:function(e){t.onChange(e)},placeholder:i("newNotePlaceHolder"),InputProps:{startAdornment:(0,H.jsx)(F.Z,{position:"start",children:(0,H.jsx)(R.Z,{icon:"eva:search-fill",sx:{color:"text.add"}})})}})}})]})]})}var B=n(53106),M=n(62861),W=n(68096),V=n(77196),G=n(82626),q=n(58406),Q=n(80831),J=function(e){return(0,(0,Q.Z)().t)(e)},U=function(){return[J("None"),J("Acknowledged"),J("NotAcknowledged"),J("TempAcknowledged"),J("Reject")]},K=function(e){return(0,(0,Q.Z)().t)(e)},X=function(){return[K("NotStarted"),K("InProgress"),K("Installed"),K("Delayed")]},$=n(64554),Y=n(79836),ee=n(9195),te=n(56890),ne=n(68745),re=n(53382),ae=n(24308),ie=n(39281),oe=n(47974);function le(e){var t=e.department,n=(e.filters,e.onFilters,e.departmentOptions),r=e.currentInvoice,a=(0,s.useState)(!0),u=(0,l.Z)(a,2),d=(u[0],u[1]),p=(0,s.useState)([]),h=(0,l.Z)(p,2),x=h[0],v=h[1],m=(0,s.useState)([]),Z=(0,l.Z)(m,2),j=Z[0],y=Z[1],S=(0,s.useState)([]),w=(0,l.Z)(S,2),C=w[0],k=w[1],D=(0,s.useState)([]),I=(0,l.Z)(D,2),T=I[0],N=I[1],L=(0,c.nt)().t,E=function(e){return L(e)};(0,s.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,f.G_)();case 3:t=e.sent,v(t),y(t.filter((function(e){return"Collection Source"===e.entityType}))),console.log(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching invoice:",e.t0);case 12:return e.prev=12,d(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),j||(console.log("collectionSource[0]: ",j),le(j[0]));var F=(0,g.Gc)(),O=F.control,R=F.watch,P=F.resetField,Q=F.setValue,J=(F.formState.errors,R()),K={deliveryDate:["operation"],department:["operation","sales","collection","tenderandcontracts"],acknowledgeStatuses:["operation","sales"],installationStatus:["installation"],installationDate:["installation"],collectionSource:["collection"],claimStatus:["collection"],claimsDetailStatus:["collection"]},le=function(e){k([]),N([]),P("claimStatus"),P("claimsDetailStatus");var t=j.filter((function(t){return t.value===e.target.value}))[0].id;k(x.filter((function(e){return e.parentId===t}))),C.length&&(Q("claimStatus",C[0].value),se(C[0].value))},se=function(e){var t=C.filter((function(t){return t.value===e}))[0].id;N(x.filter((function(e){return e.parentId===t})))},ce={},ue={width:"95%",margin:"10px",borderRadius:"10px"},de={width:"95%",margin:"10px"},pe=K.deliveryDate.includes(t.toLowerCase())?(0,H.jsx)(g.Qr,{name:"DeliveryDate",control:O,render:function(e){var t=e.field;e.fieldState.error;return(0,H.jsx)(B.M,{label:E("deliveryDate"),value:t.value,onChange:function(e){t.onChange(e)},sx:ue})}}):(0,H.jsx)(z.Z,{label:E("deliveryDate"),value:r.deliveryDate&&r.deliveryDate.substring(0,null===r||void 0===r?void 0:r.deliveryDate.indexOf("T")),disabled:!0,style:de}),fe=K.department.includes(t.toLowerCase())?(0,H.jsxs)(W.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:de,children:[(0,H.jsx)(M.Z,{children:" Department "}),(0,H.jsx)(g.Qr,{name:"department",control:O,render:function(e){var t=e.field;return(0,H.jsx)(q.Z,{style:ce,value:t.value,onChange:function(e){t.onChange(e)},input:(0,H.jsx)(V.Z,{label:E("department")}),renderValue:function(e){return e},sx:{flex:1,textField:{textTransform:"capitalize",fullWidth:!0}},children:n.map((function(e,t){return(0,H.jsx)(G.Z,{value:e,children:e},t)}))})}})]}):(0,H.jsx)(z.Z,{label:E("department"),value:null===r||void 0===r?void 0:r.department,style:de,disabled:!0}),he=K.acknowledgeStatuses.includes(t.toLowerCase())?(0,H.jsxs)(W.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:de,children:[(0,H.jsx)(M.Z,{children:" Acknowledge Status "}),(0,H.jsx)(g.Qr,{name:"acknowledgeStatus",control:O,render:function(e){var n=e.field;return(0,H.jsx)(q.Z,{style:ce,value:n.value,onChange:function(e){n.onChange(e)},input:(0,H.jsx)(V.Z,{label:E("acknowledgeStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:U().map((function(e){return(0,H.jsx)(G.Z,{value:e,defaultChecked:e===t,children:e},e)}))})}})]}):(0,H.jsx)(z.Z,{label:E("acknowledgeStatus"),value:null===r||void 0===r?void 0:r.acknowledgeStatus,style:de,disabled:!0}),xe=K.installationDate.includes(t.toLowerCase())?(0,H.jsx)(g.Qr,{name:"installationDate",control:O,render:function(e){var t=e.field;e.fieldState.error;return(0,H.jsx)(B.M,{label:E("installationDate"),value:t.value,onChange:function(e){t.onChange(e)},sx:ue})}}):(0,H.jsx)(z.Z,{label:E("installationDate"),value:r.installationDate,style:de,disabled:!0}),ve=K.installationStatus.includes(t.toLowerCase())?(0,H.jsxs)(W.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:de,children:[(0,H.jsx)(M.Z,{children:E("installationStatus")}),(0,H.jsx)(g.Qr,{name:"installationStatus",control:O,render:function(e){var t=e.field;return(0,H.jsx)(q.Z,{style:ce,value:t.value,onChange:function(e){t.onChange(e)},input:(0,H.jsx)(V.Z,{label:E("installationStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:X().map((function(e,t){return(0,H.jsx)(G.Z,{value:e,children:e},t)}))})}})]}):(0,H.jsx)(z.Z,{label:E("installationStatus"),value:r.installationStatus,style:de,disabled:!0}),me=K.collectionSource.includes(t.toLowerCase())?(0,H.jsxs)(W.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:de,children:[(0,H.jsx)(M.Z,{children:" Collection Source "}),(0,H.jsx)(g.Qr,{name:"collectionSource",control:O,render:function(e){var t=e.field;return(0,H.jsx)(q.Z,{style:ce,value:t.value,onChange:function(e){t.onChange(e),le(e)},input:(0,H.jsx)(V.Z,{label:E("collectionSource")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:j&&j.map((function(e,t){return(0,H.jsx)(G.Z,{value:e.value,children:e.value},t)}))})}})]}):(0,H.jsx)(z.Z,{label:E("collectionSource"),value:r.collectionSource,style:de,disabled:!0}),Ze=K.claimStatus.includes(t.toLowerCase())?(0,H.jsxs)(W.Z,{sx:{flex:1,flexShrink:0,width:{xs:3}},style:de,children:[(0,H.jsx)(M.Z,{children:" Claim Status "}),(0,H.jsx)(g.Qr,{name:"claimStatus",control:O,render:function(e){var t=e.field;return(0,H.jsx)(q.Z,{style:ce,value:t.value,onChange:function(e){t.onChange(e),function(e){var t=C.filter((function(t){return t.value===e.target.value}))[0].id;N(x.filter((function(e){return e.parentId===t}))),P("claimsDetailStatus")}(e)},input:(0,H.jsx)(V.Z,{label:E("claimStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:C.map((function(e,t){return(0,H.jsx)(G.Z,{value:e.value,children:e.value},t)}))})}})]}):(0,H.jsx)(z.Z,{label:E("claimStatus"),value:r.claimStatus,style:de,disabled:!0}),ge=K.claimsDetailStatus.includes(t.toLowerCase())?(0,H.jsxs)(W.Z,{sx:{flex:1,flexShrink:0,width:{xs:3,md:"80%"}},style:de,children:[(0,H.jsx)(M.Z,{children:" Claims Detail Status "}),(0,H.jsx)(g.Qr,{name:"claimsDetailStatus",control:O,render:function(e){var t=e.field;return(0,H.jsx)(q.Z,{style:ce,value:t.value,onChange:function(e){t.onChange(e),console.log(J)},input:(0,H.jsx)(V.Z,{label:E("claimsDetailStatus")}),renderValue:function(e){return e},sx:{textTransform:"capitalize",fullWidth:!0},children:T.map((function(e,t){return(0,H.jsx)(G.Z,{value:e.value,children:e.value},t)}))})}})]}):(0,H.jsx)(z.Z,{label:E("claimsDetailStatus"),value:r.claimsDetailStatus,style:de,disabled:!0}),je=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(_.Z,{variant:"h6",gutterBottom:!0,children:E("notes")}),(0,H.jsx)(ie.Z,{sx:{overflow:"unset",mt:5},children:(0,H.jsx)(oe.Z,{children:(0,H.jsxs)(Y.Z,{sx:{minWidth:960},children:[(0,H.jsx)(te.Z,{children:(0,H.jsxs)(ee.Z,{children:[(0,H.jsx)(ne.Z,{width:40,children:"#"}),(0,H.jsx)(ne.Z,{sx:{typography:"subtitle2"},children:E("note")}),(0,H.jsx)(ne.Z,{sx:{typography:"subtitle2"},children:E("user")}),(0,H.jsx)(ne.Z,{sx:{typography:"subtitle2"},children:E("createDate")})]})}),(0,H.jsx)(re.Z,{children:null===r||void 0===r?void 0:r.notes.map((function(e,t){return(0,H.jsxs)(ee.Z,{children:[(0,H.jsx)(ne.Z,{children:t+1}),(0,H.jsx)(ne.Z,{children:(0,H.jsx)(_.Z,{variant:"subtitle2",children:e.noteText})}),(0,H.jsx)(ne.Z,{children:e.createdBy}),(0,H.jsx)(ne.Z,{children:e.createdDate.substring(0,e.createdDate.indexOf("T"))})]},t)}))})]})})})]}),ye=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(_.Z,{variant:"h6",gutterBottom:!0,children:E("attachments")}),(0,H.jsx)(ie.Z,{sx:{overflow:"unset",mt:5,mb:7},children:(0,H.jsx)(oe.Z,{children:(0,H.jsxs)(Y.Z,{sx:{minWidth:960},children:[(0,H.jsx)(te.Z,{children:(0,H.jsxs)(ee.Z,{children:[(0,H.jsx)(ne.Z,{width:40,children:"#"}),(0,H.jsx)(ne.Z,{sx:{typography:"subtitle2"},children:E("name")}),(0,H.jsx)(ne.Z,{sx:{typography:"subtitle2"},children:E("user")}),(0,H.jsx)(ne.Z,{sx:{typography:"subtitle2"},children:E("createDate")})]})}),(0,H.jsx)(re.Z,{children:null===r||void 0===r?void 0:r.attachments.map((function(e,t){return(0,H.jsxs)(ee.Z,{children:[(0,H.jsx)(ne.Z,{children:t+1}),(0,H.jsx)(ne.Z,{children:(0,H.jsxs)(_.Z,{variant:"subtitle2",children:[" ",(0,H.jsx)("a",{target:"_blank",rel:"noreferrer",href:e.attachmentPath,children:e.fileName})," "]})}),(0,H.jsx)(ne.Z,{children:e.createdBy}),(0,H.jsx)(ne.Z,{children:e.createdDate.substring(0,e.createdDate.indexOf("T"))})]},t)}))})]})})})]});ae.Z,ae.Z,_.Z,_.Z,ae.Z,_.Z,_.Z;return(0,H.jsxs)(b.Z,{sx:{pt:5,px:5},children:[(0,H.jsxs)($.Z,{rowGap:1,display:"grid",alignItems:"center",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[(0,H.jsx)(z.Z,{label:E("issueDate"),value:r?null===r||void 0===r?void 0:r.issueInvoiceDate.substring(0,null===r||void 0===r?void 0:r.issueInvoiceDate.indexOf("T")):"",style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("amount"),value:null===r||void 0===r?void 0:r.invoiceAmount,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("currency"),value:null===r||void 0===r?void 0:r.currency,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("customerCode"),value:null===r||void 0===r?void 0:r.customerCode,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("nameEnglish"),value:null===r||void 0===r?void 0:r.customerNameEn,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("nameArabic"),value:null===r||void 0===r?void 0:r.customerNameAr,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("PoNumber"),value:null===r||void 0===r?void 0:r.customerPO,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("POValue"),value:null===r||void 0===r?void 0:r.poValue,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("region"),value:null===r||void 0===r?void 0:r.region,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("contractNumber"),value:null===r||void 0===r?void 0:r.contractNo,style:de,disabled:!0}),pe,xe,fe,ve,(0,H.jsx)(z.Z,{label:E("daysToCollected"),value:null===r||void 0===r?void 0:r.daysToCollected,style:de,disabled:!0}),he,me,Ze,ge,(0,H.jsx)(z.Z,{label:E("salesConfirm"),value:null===r||void 0===r?void 0:r.salesConfirm,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("createdBy"),value:null===r||void 0===r?void 0:r.createdBy,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("salesTaker"),value:null===r||void 0===r?void 0:r.salesTakerName,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("collectorName"),value:null===r||void 0===r?void 0:r.collectorName,style:de,disabled:!0}),(0,H.jsx)(z.Z,{label:E("responsibleEngineerName"),value:null===r||void 0===r?void 0:r.responsibleEngineerName,style:de,disabled:!0})]}),je,(0,H.jsx)(A.Z,{sx:{mt:5,borderStyle:"dashed",mb:3}}),ye]})}var se=function(e){return[e.toLocaleString("default",{year:"numeric"}),e.toLocaleString("default",{month:"2-digit"}),e.toLocaleString("default",{day:"2-digit"})].join("-")};function ce(e){var t=e.currentInvoice,n=(0,a.tv)(),r=((0,L.k)(),(0,L.k)()),u=(0,c.nt)().t,d=function(e){return u(e)},p=(0,s.useState)(!1),h=(0,l.Z)(p,2),x=(h[0],h[1]),A=(0,s.useState)(!1),z=(0,l.Z)(A,2),F=z[0],_=z[1],O=(0,s.useState)(""),R=(0,l.Z)(O,2),B=R[0],M=R[1],W=(0,N.j)().map((function(e){return e.toLocaleLowerCase()})).indexOf(null===t||void 0===t?void 0:t.department.toLowerCase()),V=function(){_(!1)},G={deliveryDate:["operation"],department:["operation","sales","tenderandcontracts"],acknowledgeStatuses:["operation","sales"],installationStatus:["installation"],installationDate:["installation"],collectionSource:["collection"],claimStatus:["collection"],claimsDetailStatus:["collection"]},q=Z.Ry().shape({CreateNote:Z.Z_(),department:Z.Z_(),acknowledgeStatus:Z.Z_(),DeliveryDate:Z.nK().nullable(),installationStatus:Z.Z_(),installationDate:Z.nK().nullable(),collectionSource:Z.Z_(),claimStatus:Z.Z_(),claimsDetailStatus:Z.Z_()}),Q=d("selectSource"),J=d("selectStatus"),U=d("selectDetails"),K=(0,s.useMemo)((function(){return{CreateNote:(null===t||void 0===t?void 0:t.CreateNote)||"",department:(null===t||void 0===t?void 0:t.department)||"",acknowledgeStatus:(null===t||void 0===t?void 0:t.acknowledgeStatus)||"",DeliveryDate:(null===t||void 0===t?void 0:t.DeliveryDate)||new Date,installationStatus:(null===t||void 0===t?void 0:t.installationStatus)||"",installationDate:(null===t||void 0===t?void 0:t.installationDate)||new Date,collectionSource:(null===t||void 0===t?void 0:t.CollectionSource)||Q,claimStatus:(null===t||void 0===t?void 0:t.ClaimStatus)||J,claimsDetailStatus:(null===t||void 0===t?void 0:t.ClaimsDetailStatus)||U}}),[t,Q,J,U]),X=(0,s.useState)(K),$=(0,l.Z)(X,2),Y=$[0],ee=$[1],te=(0,g.cI)({resolver:(0,j.X)(q),defaultValues:K}),ne=te.reset,re=te.watch,ae=te.handleSubmit,ie=te.formState.isSubmitting,oe=(0,s.useCallback)((function(e,t){ee((function(n){return(0,m.Z)((0,m.Z)({},n),{},(0,v.Z)({},e,t))}))}),[]),ce=ae(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(a){var o,l,s,c,u,d,p,h,v,m,Z,g,j;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ue(),r.onTrue(),e.prev=2,e.next=5,new Promise((function(e){return setTimeout(e,500)}));case 5:o=re(),l=o.CreateNote,s=o.department,c=o.acknowledgeStatus,u=o.DeliveryDate,d=o.installationDate,p=o.installationStatus,h=o.collectionSource,v=o.claimStatus,m=o.claimsDetailStatus,Z=[],s&&G.department.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/department",value:"".concat(s)}),c&&G.acknowledgeStatuses.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/acknowledgeStatus",value:"".concat(c)}),u&&G.deliveryDate.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/DeliveryDate",value:"".concat(se(u))}),d&&G.installationDate.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/InstallationDate",value:"".concat(se(d))}),p&&G.installationStatus.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/installationStatus",value:"".concat(p)}),h&&G.collectionSource.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/CollectionSource",value:"".concat(h)}),v&&G.claimStatus.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/ClaimStatus",value:"".concat(v)}),m&&G.claimsDetailStatus.includes(t.department.toLowerCase())&&Z.push({op:"replace",path:"/ClaimsDetailStatus",value:"".concat(m)}),Z.push({op:"add",path:"/CreateNote",value:{NoteText:"".concat(l)}}),ne(),g=(0,f.iJ)(W),console.log("Body",JSON.stringify(Z)),j=(0,f.kT)(W,t.id),console.log("Url",j),fetch(j,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(Z),Cache:"default"}).then((function(e){if(!e.ok){if(400===e.status)return e.text().then((function(e){throw M(e),_(!0),new Error("Bad Request: ".concat(e))}));throw new Error("Network response was not ok")}return e.text()})).then((function(e){x(!0),r.onFalse(),n.replace(g),console.log("res:",e)})).catch((function(e){console.error("Fetch Error:",e)})),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(2),console.error("Error:",e.t0),r.onFalse();case 28:case"end":return e.stop()}}),e,null,[[2,24]])})));return function(t){return e.apply(this,arguments)}}()),ue=function(){var e=new FormData,n=document.querySelector("#file").files[0];if(n){e.append("file",n);try{var r=(0,f.ZN)(t.id);console.log("Url",r),fetch(r,{mode:"cors",method:"POST",headers:{Accept:"application/json"},body:e,Cache:"default"}).then(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,3e3)}));case 2:if(t.ok){e.next=9;break}if(400!==t.status&&415!==t.status){e.next=8;break}return e.next=6,t.text();case 6:throw n=e.sent,new Error("Bad Request: ".concat(n));case 8:throw new Error("Network response was not ok");case 9:return e.abrupt("return",t.text());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){})).catch((function(e){console.error("Fetch Error:",e)}))}catch(a){console.log(a)}}};return(0,H.jsxs)(E.ZP,{methods:te,onSubmit:ce,children:[(0,H.jsxs)(b.Z,{children:[(0,H.jsx)(P,{currentInvoice:t}),(0,H.jsx)(le,{currentInvoice:t,filters:Y,onFilters:oe,departmentOptions:(0,N.j)().map((function(e){return e})),department:t.department})]}),(0,H.jsx)(S.Z,{justifyContent:"flex-end",direction:"row",spacing:2,sx:{mt:3},children:(0,H.jsxs)(y.Z,{size:"large",variant:"contained",loading:r.value&&ie,type:"submit",children:[t?"Update":"Create"," & Send"]})}),(0,H.jsxs)(C.Z,{open:F,color:"#ef5350",keepMounted:!0,onClose:V,"aria-describedby":"alert-dialog-slide-description",className:"dialog-error",children:[(0,H.jsx)(T.Z,{children:"Error"}),(0,H.jsx)(D.Z,{children:(0,H.jsx)(I.Z,{id:"alert-dialog-slide-description",children:String(B)})}),(0,H.jsx)(k.Z,{children:(0,H.jsx)(w.Z,{onClick:V,children:"Ok"})})]})]})}function ue(e){var t=e.id,n=(0,h.K$)(),r=(0,c.nt)().t,a=function(e){return r(e)},v=(0,s.useState)(null),m=(0,l.Z)(v,2),Z=m[0],g=m[1],j=(0,s.useState)(!0),y=(0,l.Z)(j,2),b=y[0],S=y[1];return(0,s.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,f.Ag)(t);case 3:n=e.sent,g(n),console.log(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error fetching invoice:",e.t0);case 11:return e.prev=11,S(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]),b||!Z?(0,H.jsx)(d.Z,{}):(0,H.jsxs)(u.Z,{maxWidth:!n.themeStretch&&"lg",children:[(0,H.jsx)(x.Z,{heading:"Edit invoice",links:[{name:a("app"),href:p.H.dashboard.root},{name:a("invoice"),href:p.H.dashboard.invoice.root},{name:a("newInvoice")}],sx:{mb:{xs:3,md:5}}}),(0,H.jsx)(ce,{currentInvoice:Z})]})}function de(){var e=(0,a.UO)(),t=e.id;return console.log(e),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(r.ql,{children:(0,H.jsx)("title",{children:" Edit invoice"})}),(0,H.jsx)(ue,{id:t})]})}},51691:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(63366),a=n(87462),i=n(72791),o=n(59278),l=n(94419),s=n(66934),c=n(31402),u=n(4567),d=n(75878),p=n(21217);function f(e){return(0,p.Z)("MuiDialogContentText",e)}(0,d.Z)("MuiDialogContentText",["root"]);var h=n(80184),x=["children","className"],v=(0,s.ZP)(u.Z,{shouldForwardProp:function(e){return(0,s.FO)(e)||"classes"===e},name:"MuiDialogContentText",slot:"Root",overridesResolver:function(e,t){return t.root}})({}),m=i.forwardRef((function(e,t){var n=(0,c.Z)({props:e,name:"MuiDialogContentText"}),i=n.className,s=(0,r.Z)(n,x),u=function(e){var t=e.classes,n=(0,l.Z)({root:["root"]},f,t);return(0,a.Z)({},t,n)}(s);return(0,h.jsx)(v,(0,a.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:s,className:(0,o.Z)(u.root,i)},n,{classes:u}))}))},65661:function(e,t,n){var r=n(87462),a=n(63366),i=n(72791),o=n(59278),l=n(94419),s=n(4567),c=n(66934),u=n(31402),d=n(17673),p=n(85090),f=n(80184),h=["className","id"],x=(0,c.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:function(e,t){return t.root}})({padding:"16px 24px",flex:"0 0 auto"}),v=i.forwardRef((function(e,t){var n=(0,u.Z)({props:e,name:"MuiDialogTitle"}),s=n.className,c=n.id,v=(0,a.Z)(n,h),m=n,Z=function(e){var t=e.classes;return(0,l.Z)({root:["root"]},d.a,t)}(m),g=i.useContext(p.Z).titleId,j=void 0===g?c:g;return(0,f.jsx)(x,(0,r.Z)({component:"h2",className:(0,o.Z)(Z.root,s),ownerState:m,ref:t,variant:"h6",id:null!=c?c:j},v))}));t.Z=v},68745:function(e,t,n){var r=n(4942),a=n(63366),i=n(87462),o=n(72791),l=n(59278),s=n(94419),c=n(12065),u=n(14036),d=n(46646),p=n(829),f=n(31402),h=n(66934),x=n(90618),v=n(80184),m=["align","className","component","padding","scope","size","sortDirection","variant"],Z=(0,h.ZP)("td",{name:"MuiTableCell",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.variant],t["size".concat((0,u.Z)(n.size))],"normal"!==n.padding&&t["padding".concat((0,u.Z)(n.padding))],"inherit"!==n.align&&t["align".concat((0,u.Z)(n.align))],n.stickyHeader&&t.stickyHeader]}})((function(e){var t=e.theme,n=e.ownerState;return(0,i.Z)({},t.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:t.vars?"1px solid ".concat(t.vars.palette.TableCell.border):"1px solid\n    ".concat("light"===t.palette.mode?(0,c.$n)((0,c.Fq)(t.palette.divider,1),.88):(0,c._j)((0,c.Fq)(t.palette.divider,1),.68)),textAlign:"left",padding:16},"head"===n.variant&&{color:(t.vars||t).palette.text.primary,lineHeight:t.typography.pxToRem(24),fontWeight:t.typography.fontWeightMedium},"body"===n.variant&&{color:(t.vars||t).palette.text.primary},"footer"===n.variant&&{color:(t.vars||t).palette.text.secondary,lineHeight:t.typography.pxToRem(21),fontSize:t.typography.pxToRem(12)},"small"===n.size&&(0,r.Z)({padding:"6px 16px"},"&.".concat(x.Z.paddingCheckbox),{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}),"checkbox"===n.padding&&{width:48,padding:"0 0 0 4px"},"none"===n.padding&&{padding:0},"left"===n.align&&{textAlign:"left"},"center"===n.align&&{textAlign:"center"},"right"===n.align&&{textAlign:"right",flexDirection:"row-reverse"},"justify"===n.align&&{textAlign:"justify"},n.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(t.vars||t).palette.background.default})})),g=o.forwardRef((function(e,t){var n,r=(0,f.Z)({props:e,name:"MuiTableCell"}),c=r.align,h=void 0===c?"inherit":c,g=r.className,j=r.component,y=r.padding,b=r.scope,S=r.size,w=r.sortDirection,C=r.variant,k=(0,a.Z)(r,m),D=o.useContext(d.Z),I=o.useContext(p.Z),T=I&&"head"===I.variant,N=b;"td"===(n=j||(T?"th":"td"))?N=void 0:!N&&T&&(N="col");var L=C||I&&I.variant,E=(0,i.Z)({},r,{align:h,component:n,padding:y||(D&&D.padding?D.padding:"normal"),size:S||(D&&D.size?D.size:"medium"),sortDirection:w,stickyHeader:"head"===L&&D&&D.stickyHeader,variant:L}),A=function(e){var t=e.classes,n=e.variant,r=e.align,a=e.padding,i=e.size,o={root:["root",n,e.stickyHeader&&"stickyHeader","inherit"!==r&&"align".concat((0,u.Z)(r)),"normal"!==a&&"padding".concat((0,u.Z)(a)),"size".concat((0,u.Z)(i))]};return(0,s.Z)(o,x.U,t)}(E),z=null;return w&&(z="asc"===w?"ascending":"descending"),(0,v.jsx)(Z,(0,i.Z)({as:n,ref:t,className:(0,l.Z)(A.root,g),"aria-sort":z,scope:N,ownerState:E},k))}));t.Z=g},46646:function(e,t,n){var r=n(72791).createContext();t.Z=r},829:function(e,t,n){var r=n(72791).createContext();t.Z=r}}]);
//# sourceMappingURL=2435.eb81a46d.chunk.js.map