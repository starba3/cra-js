"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[3931],{13931:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ze}});var r=t(6907),i=t(4942),o=t(1413),s=t(74165),a=t(15861),l=t(29439),c=t(72791),u=t(31357),d=t.n(u),p=t(69931),x=t(13967),h=t(4567),f=t(57621),m=t(79836),Z=t(36314),j=t(5849),v=t(94721),g=t(89164),b=t(53382),w=t(13400),y=t(39281),C=t(56890),k=t(9195),D=t(68745),S=t(48550),P=t(5574),I=t(97123),R=t(39157),F=t(65661),O=t(63515),A=t(62711),E=t(56125),N=t(13239),W=t(38072),T=t(19208),L=t(83854),z=t(22459),q=t(9145),B=t(27216),_=t(47974),M=t(3352),V=t(60720),H=t(50933),U=t(1382),Q=t(91617),K=t(41557),$=t(62633),G=t(11276),J=t(49088),X=t(10370),Y=t(16386),ee=t(50533),ne=t(60220),te=t(82626),re=t(13034),ie=t(49900),oe=t(52115),se=t(80184);function ae(e){var n=e.row,t=e.selected,r=e.onSelectRow,i=e.onViewRow,o=(e.onEditRow,e.onDeleteRow),s=e.handleOpenInquiry,a=(n.id,n.invoiceNo),l=n.issueInvoiceDate,c=n.invoiceAmount,u=n.daysToCollected,d=n.customerNameAr,x=n.customerNameEn,f=n.paidStatus,m=n.department,Z=(0,p.nt)(),g=Z.t,b="ar"===Z.currentLang.value?d:x,y=function(e){return g(e)},C=(0,z.k)(),S=(0,oe.S)();return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(k.Z,{hover:!0,selected:t,children:[(0,se.jsx)(D.Z,{padding:"checkbox",children:(0,se.jsx)(re.Z,{checked:t,onClick:r})}),(0,se.jsxs)(D.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,se.jsx)(ne.Z,{alt:b,sx:{mr:2},children:b.charAt(0).toUpperCase()}),(0,se.jsx)(ie.Z,{disableTypography:!0,primary:(0,se.jsx)(h.Z,{variant:"body2",noWrap:!0,children:b}),secondary:(0,se.jsx)(ee.Z,{noWrap:!0,variant:"body2",onClick:i,sx:{color:"text.disabled",cursor:"pointer"},children:a})})]}),(0,se.jsx)(D.Z,{children:(0,se.jsx)(ie.Z,{primary:(0,Y.Z)(new Date(l),"dd MMM yyyy"),secondary:(0,Y.Z)(new Date(l),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),(0,se.jsx)(D.Z,{children:u}),(0,se.jsxs)(D.Z,{children:["$",c]}),(0,se.jsx)(D.Z,{align:"center",children:f}),(0,se.jsx)(D.Z,{align:"center",children:m}),(0,se.jsx)(D.Z,{align:"right",sx:{px:1},children:(0,se.jsx)(w.Z,{color:S.open?"inherit":"default",onClick:S.onOpen,children:(0,se.jsx)(B.Z,{icon:"eva:more-vertical-fill"})})})]}),(0,se.jsxs)(oe.Z,{open:S.open,onClose:S.onClose,arrow:"right-top",sx:{width:160},children:[(0,se.jsxs)(te.Z,{onClick:function(){i(),S.onClose()},children:[(0,se.jsx)(B.Z,{icon:"solar:eye-bold"}),y("view")]}),(0,se.jsxs)(te.Z,{onClick:function(){s(),S.onClose()},children:[(0,se.jsx)(B.Z,{icon:"bx:file"}),y("inquiry")]}),(0,se.jsx)(v.Z,{sx:{borderStyle:"solid"}}),(0,se.jsxs)(te.Z,{onClick:function(){C.onTrue(),S.onClose()},sx:{color:"error.main"},children:[(0,se.jsx)(B.Z,{icon:"solar:trash-bin-trash-bold"}),y("delete")]})]}),(0,se.jsx)(M.Q,{open:C.value,onClose:C.onFalse,title:y("delete"),content:y("deleteComfirmationMessage"),action:(0,se.jsx)(j.Z,{variant:"contained",color:"error",onClick:function(){console.log("Delete clicked"),o(),C.onFalse()},children:y("delete")})})]})}var le=t(53106),ce=t(62861),ue=t(68096),de=t(63466),pe=t(77196),xe=t(58406);function he(e){var n=e.filters,t=e.onFilters,r=e.dateError,i=e.serviceOptions,o=e.paidStatusOptions,s=(0,oe.S)(),a=(0,p.nt)().t,l=function(e){return a(e)},u=(0,c.useCallback)((function(e){t("name",e.target.value)}),[t]),d=(0,c.useCallback)((function(e){t("service","string"===typeof e.target.value?e.target.value.split(","):e.target.value)}),[t]),x=(0,c.useCallback)((function(e){t("paidStatus","string"===typeof e.target.value?e.target.value.split(","):e.target.value)}),[t]),h=(0,c.useCallback)((function(e){t("startDate",e)}),[t]),f=(0,c.useCallback)((function(e){t("endDate",e)}),[t]);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Z.Z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[(0,se.jsxs)(ue.Z,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[(0,se.jsx)(ce.Z,{children:l("departments")}),(0,se.jsx)(xe.Z,{multiple:!0,value:n.service,onChange:d,input:(0,se.jsx)(pe.Z,{label:l("departments")}),renderValue:function(e){return e.map((function(e){return e})).join(", ")},sx:{textTransform:"capitalize"},children:i.map((function(e){return(0,se.jsxs)(te.Z,{value:e,children:[(0,se.jsx)(re.Z,{disableRipple:!0,size:"small",checked:n.service.includes(e)}),e]},e)}))})]}),(0,se.jsxs)(ue.Z,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[(0,se.jsx)(ce.Z,{children:l("paidStatus")}),(0,se.jsx)(xe.Z,{multiple:!0,value:n.paidStatus,onChange:x,input:(0,se.jsx)(pe.Z,{label:l("paidStatus")}),renderValue:function(e){return e.map((function(e){return e})).join(", ")},sx:{textTransform:"capitalize"},children:o.map((function(e){return(0,se.jsxs)(te.Z,{value:e,children:[(0,se.jsx)(re.Z,{disableRipple:!0,size:"small",checked:n.paidStatus.includes(e)}),e]},e)}))})]}),(0,se.jsx)(le.M,{label:l("startDate"),value:n.startDate,onChange:h,slotProps:{textField:{fullWidth:!0}},sx:{maxWidth:{md:180}}}),(0,se.jsx)(le.M,{label:l("startDate"),value:n.endDate,onChange:f,slotProps:{textField:{fullWidth:!0,error:r}},sx:{maxWidth:{md:180}}}),(0,se.jsx)(Z.Z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:(0,se.jsx)(S.Z,{fullWidth:!0,value:n.name,onChange:u,placeholder:l("searchInvoiceNamePlaceHolder"),InputProps:{startAdornment:(0,se.jsx)(de.Z,{position:"start",children:(0,se.jsx)(B.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]}),(0,se.jsxs)(oe.Z,{open:s.open,onClose:s.onClose,arrow:"right-top",sx:{width:140},children:[(0,se.jsxs)(te.Z,{onClick:function(){s.onClose()},children:[(0,se.jsx)(B.Z,{icon:"solar:printer-minimalistic-bold"}),l("print")]}),(0,se.jsxs)(te.Z,{onClick:function(){s.onClose()},children:[(0,se.jsx)(B.Z,{icon:"solar:import-bold"}),l("import")]}),(0,se.jsxs)(te.Z,{onClick:function(){s.onClose()},children:[(0,se.jsx)(B.Z,{icon:"solar:export-bold"}),l("export")]})]})]})}var fe={name:"",service:[],paidStatus:[],status:"all",startDate:null,endDate:null};function me(){var e=(0,x.Z)(),n=(0,V.K$)(),t=(0,T.tv)(),r=(0,U.x6)({defaultOrderBy:"issueInvoiceDate"}),u=(0,z.k)(),Y=(0,p.nt)(),ee=Y.t,ne=Y.currentLang,te=function(e){return ee(e)},re=(0,c.useState)([]),ie=(0,l.Z)(re,2),oe=ie[0],le=ie[1],ce=(0,c.useState)(!1),ue=(0,l.Z)(ce,2),de=ue[0],pe=ue[1],xe=(0,c.useState)(fe),me=(0,l.Z)(xe,2),Ze=me[0],je=me[1],ve=c.useState(!1),ge=(0,l.Z)(ve,2),be=ge[0],we=ge[1],ye=(0,c.useState)(!1),Ce=(0,l.Z)(ye,2),ke=(Ce[0],Ce[1],(0,c.useState)([""])),De=(0,l.Z)(ke,2),Se=(De[0],De[1],(0,c.useState)(!1)),Pe=(0,l.Z)(Se,2),Ie=Pe[0],Re=Pe[1],Fe=(0,c.useState)(!1),Oe=(0,l.Z)(Fe,2),Ae=Oe[0],Ee=Oe[1],Ne=(0,c.useState)(""),We=(0,l.Z)(Ne,2),Te=We[0],Le=We[1],ze=(0,c.useState)(!1),qe=(0,l.Z)(ze,2),Be=qe[0],_e=qe[1],Me=(0,c.useState)(!1),Ve=(0,l.Z)(Me,2),He=Ve[0],Ue=Ve[1],Qe=(0,c.useState)(0),Ke=(0,l.Z)(Qe,2),$e=Ke[0],Ge=Ke[1],Je=(0,c.useState)({}),Xe=(0,l.Z)(Je,2),Ye=Xe[0],en=Xe[1];(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Q.qL)();case 3:n=e.sent,le(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching invoices:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[de]),(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!$e){e.next=8;break}return e.next=4,(0,Q.DW)($e);case 4:n=e.sent,en(n),e.next=9;break;case 8:en({});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching invoices:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();e()}),[$e]);var nn=!(!Ze.startDate||!Ze.endDate)&&Ze.startDate.getTime()>Ze.endDate.getTime(),tn=function(e){var n=e.inputData,t=e.comparator,r=e.filters,i=e.dateError,o=r.name,s=r.status,a=r.service,l=r.startDate,c=r.paidStatus,u=r.endDate,d=n.map((function(e,n){return[e,n]}));d.sort((function(e,n){var r=t(e[0],n[0]);return 0!==r?r:e[1]-n[1]})),n=d.map((function(e){return e[0]})),o&&(n=n.filter((function(e){return-1!==e.customerNameEn.toLowerCase().indexOf(o.toLowerCase())||-1!==e.invoiceNo.toLowerCase().indexOf(o.toLowerCase())})));"all"!==s&&(n=n.filter((function(e){return e.status===s})));a.length&&(n=n.filter((function(e){return a.includes("All")||a.includes(e.department)})));c.length&&(n=n.filter((function(e){return c.includes("All")||c.map((function(e){return e.toLowerCase()})).includes(e.paidStatus)})));i||l&&u&&(n=n.filter((function(e){return(0,q.IO)(e.issueInvoiceDate)>=(0,q.IO)(l)&&(0,q.IO)(e.issueInvoiceDate)<=(0,q.IO)(u)})));return n}({inputData:oe,comparator:(0,U.sQ)(r.order,r.orderBy),filters:Ze,dateError:nn}),rn=tn.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage),on=r.dense?56:76,sn=!!Ze.name||!!Ze.service.length||"all"!==Ze.status||!!Ze.startDate&&!!Ze.endDate,an=[{id:"invoiceNumber",label:te("invoiceNumber")},{id:"issueInvoiceDate",label:te("issueInvoiceDate")},{id:"daysToCollected",label:te("daysToCollected")},{id:"invoiceAmount",label:te("invoiceAmount")},{id:"paidStatus",label:te("paidStatus"),align:"center"},{id:"department",label:te("department"),align:"center"},{id:""}],ln=[te("invoiceNumber"),te("customerName"),te("issueInvoiceDate"),te("daysToCollected"),te("invoiceAmount"),te("paidStatus"),te("department")],cn=!tn.length&&sn||!tn.length,un=function(e){return oe.filter((function(n){return n.paidStatus===e})).length},dn=function(e){return d()(oe.filter((function(n){return n.paidStatus===e})),"invoiceAmount")},pn=function(e){return un(e)/oe.length*100},xn=(0,c.useCallback)((function(e,n){r.onResetPage(),je((function(t){return(0,o.Z)((0,o.Z)({},t),{},(0,i.Z)({},e,n))}))}),[r]),hn=(0,c.useCallback)((function(){var e=oe.filter((function(e){return!r.selected.includes(e.id)}));le(e),r.onUpdatePageDeleteRows({totalRows:oe.length,totalRowsInPage:rn.length,totalRowsFiltered:tn.length})}),[tn.length,rn.length,r,oe]),fn=(0,c.useCallback)((function(e){t.push(W.H.dashboard.invoice.edit(e))}),[t]),mn=(0,c.useCallback)((function(e){t.push(W.H.dashboard.invoice.details(e))}),[t]),Zn=((0,c.useCallback)((function(e,n){xn("paidStatus",n)}),[xn]),(0,c.useCallback)((function(){je(fe)}),[])),jn=function(){we(!1),Ee(!1)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(g.Z,{maxWidth:!n.themeStretch&&"lg",children:[(0,se.jsx)(H.Z,{heading:te("list"),links:[{name:te("app"),href:W.H.dashboard.root},{name:te("invoice")},{name:te("list")}],action:(0,se.jsxs)(Z.Z,{direction:"row",divider:(0,se.jsx)(v.Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[(0,se.jsx)(j.Z,{component:L.r,href:W.H.dashboard.invoice.new,variant:"contained",startIcon:(0,se.jsx)(B.Z,{icon:"mingcute:add-line"}),children:te("newInvoice")}),(0,se.jsx)(j.Z,{component:L.r,variant:"contained",color:"primary",onClick:function(){we(!0)},startIcon:(0,se.jsx)(B.Z,{icon:"solar:import-bold"}),children:te("import")}),(0,se.jsx)(j.Z,{variant:"contained",color:"primary",onClick:function(){return(0,G.p)(oe,ln,ne.value,"AllInvoices","ExportFile")},startIcon:(0,se.jsx)(B.Z,{icon:"eva:download-outline"}),children:te("export")})]}),sx:{mb:{xs:3,md:5}}}),(0,se.jsx)(f.Z,{sx:{mb:{xs:3,md:5}},children:(0,se.jsx)(_.Z,{children:(0,se.jsxs)(Z.Z,{direction:"row",divider:(0,se.jsx)(v.Z,{orientation:"vertical",flexItem:!0,sx:{borderStyle:"dashed"}}),sx:{py:2},children:[(0,se.jsx)(J.Z,{title:te("total"),total:oe.length,percent:100,price:d()(oe,"invoiceAmount"),icon:"solar:bill-list-bold-duotone",color:e.palette.info.main}),(0,se.jsx)(J.Z,{title:te("paid"),total:un("paid"),percent:pn("paid"),price:dn("paid"),icon:"solar:file-check-bold-duotone",color:e.palette.success.main}),(0,se.jsx)(J.Z,{title:te("unpaid"),total:un("unpaid"),percent:pn("unpaid"),price:dn("unpaid"),icon:"solar:sort-by-time-bold-duotone",color:e.palette.warning.main})]})})}),(0,se.jsxs)(f.Z,{children:[(0,se.jsx)(he,{filters:Ze,onFilters:xn,dateError:nn,serviceOptions:(0,K.b)().map((function(e){return e})),paidStatusOptions:(0,$.O)().map((function(e){return e}))}),sn&&(0,se.jsx)(X.Z,{filters:Ze,onFilters:xn,onResetFilters:Zn,results:tn.length,sx:{p:2.5,pt:0}}),(0,se.jsx)(y.Z,{sx:{position:"relative",overflow:"unset"},children:(0,se.jsx)(_.Z,{children:(0,se.jsxs)(m.Z,{size:r.dense?"small":"medium",sx:{minWidth:800},children:[(0,se.jsx)(U.K,{order:r.order,orderBy:r.orderBy,headLabel:an,rowCount:oe.length,numSelected:r.selected.length,onSort:r.onSort,onSelectAllRows:function(e){return r.onSelectAllRows(e,oe.map((function(e){return e.id})))}}),(0,se.jsxs)(b.Z,{children:[tn.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage).map((function(e){return(0,se.jsx)(ae,{row:e,selected:r.selected.includes(e.id),onSelectRow:function(){return r.onSelectRow(e.id)},onViewRow:function(){return mn(e.id)},onEditRow:function(){return fn(e.id)},onDeleteRow:function(){return function(e){var n=!0,t=function(){var t=(0,a.Z)((0,s.Z)().mark((function t(){var r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,Q.Wu)(e);case 3:n=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error fetching invoices:",t.t0);case 9:if(console.log("Success status: ",n),!n){t.next=22;break}return t.prev=11,t.next=14,(0,Q.qL)();case 14:r=t.sent,le(r),t.next=21;break;case 18:t.prev=18,t.t1=t.catch(11),console.error("Error fetching invoices:",t.t1);case 21:pe(!de);case 22:case"end":return t.stop()}}),t,null,[[0,6],[11,18]])})));return function(){return t.apply(this,arguments)}}();t()}(e.id)},handleOpenInquiry:function(){return n=e.id,Ge(n),void Ue(!0);var n}},e.id)})),(0,se.jsx)(U.$W,{height:on,emptyRows:(0,U.fQ)(r.page,r.rowsPerPage,oe.length)}),(0,se.jsx)(U.et,{notFound:cn})]})]})})}),(0,se.jsx)(U.S_,{count:tn.length,page:r.page,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onRowsPerPageChange:r.onChangeRowsPerPage,dense:r.dense,onChangeDense:r.onChangeDense})]})]}),(0,se.jsx)(M.Q,{open:u.value,onClose:u.onFalse,title:te("delete"),content:(0,se.jsxs)(se.Fragment,{children:["Are you sure want to delete ",(0,se.jsxs)("strong",{children:[" ",r.selected.length," "]})," items?"]}),action:(0,se.jsx)(j.Z,{variant:"contained",color:"error",onClick:function(){hn(),u.onFalse()},children:"Delete"})}),(0,se.jsxs)(P.Z,{open:be,onClose:jn,children:[(0,se.jsx)(F.Z,{children:"File upload"}),(0,se.jsxs)(R.Z,{children:[(0,se.jsx)(S.Z,{autoFocus:!0,required:!0,margin:"dense",id:"file",label:te("importFile"),type:"file",fullWidth:!0,variant:"standard",inputProps:{accept:".xls, .xlsx"}}),(0,se.jsx)(E.Z,{in:Ae,children:(0,se.jsx)(O.Z,{severity:Ie?"error":"success",action:(0,se.jsx)(w.Z,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){Ee(!1)},children:(0,se.jsx)(A.JO,{icon:"ic:baseline-close"})}),sx:{mb:2},children:Te})}),Be&&(0,se.jsx)(N.Z,{})]}),(0,se.jsxs)(I.Z,{children:[(0,se.jsx)(j.Z,{onClick:jn,children:te("cancel")}),(0,se.jsx)(j.Z,{onClick:function(){console.log("Loading:",Be);var e=new FormData,n=document.querySelector("#file").files[0];if(n){_e(!0),e.append("file",n);try{console.log("Loading",Be);var t=(0,Q.OX)();console.log("Url",t),fetch(t,{mode:"cors",method:"POST",headers:{Accept:"application/json"},body:e,Cache:"default"}).then(function(){var e=(0,a.Z)((0,s.Z)().mark((function e(n){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,3e3)}));case 2:if(n.ok){e.next=9;break}if(400!==n.status&&415!==n.status){e.next=8;break}return e.next=6,n.text();case 6:throw t=e.sent,new Error("Bad Request: ".concat(t));case 8:throw new Error("Network response was not ok");case 9:return e.abrupt("return",n.text());case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).then((function(e){Re(!1),Le(e)})).catch((function(e){console.error("Fetch Error:",e),Le("Invalid Data, check the file and try again"),Re(!0)}))}catch(r){}finally{_e(!1)}}else Re(!0),Le("No file selecetd.");Ee(!0)},children:te("import")})]})]}),(0,se.jsxs)(P.Z,{open:He,maxWidth:!1,color:"#ef5350",keepMounted:!0,onClose:jn,children:[(0,se.jsx)(F.Z,{children:te("invoiceInquiry")}),(0,se.jsxs)(R.Z,{children:[(0,se.jsxs)(Z.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,se.jsx)(h.Z,{children:te("invoiceNumber")}),(0,se.jsx)(h.Z,{children:te("createdBy")}),(0,se.jsx)(h.Z,{children:te("creationDate")})]}),Object.prototype.hasOwnProperty.call(Ye,"invoiceData")&&(0,se.jsxs)(Z.Z,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[(0,se.jsx)(h.Z,{children:Ye.invoiceData.invoiceNO}),(0,se.jsx)(h.Z,{children:Ye.invoiceData.createdBy}),(0,se.jsx)(h.Z,{children:Ye.invoiceData.createdDate.substring(0,Ye.invoiceData.createdDate.indexOf("T"))})]}),(0,se.jsxs)(y.Z,{sx:{position:"relative",overflow:"unset"},children:[(0,se.jsx)(C.Z,{children:(0,se.jsxs)(k.Z,{children:[(0,se.jsx)(D.Z,{children:te("property")}),(0,se.jsx)(D.Z,{align:"right",children:te("oldValue")}),(0,se.jsx)(D.Z,{align:"right",children:te("newValue")}),(0,se.jsx)(D.Z,{align:"right",children:te("lastUpdated")}),(0,se.jsx)(D.Z,{align:"right",children:te("updatedBy")})]})}),(0,se.jsx)(b.Z,{children:Object.prototype.hasOwnProperty.call(Ye,"logs")&&Ye.logs.map((function(e){return(0,se.jsxs)(k.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,se.jsx)(D.Z,{component:"th",scope:"row",children:e.propertyName}),(0,se.jsx)(D.Z,{align:"right",children:e.oldValue}),(0,se.jsx)(D.Z,{align:"right",children:e.newValue}),(0,se.jsx)(D.Z,{align:"right",children:e.dateModified.substring(0,e.dateModified.indexOf("T"))}),(0,se.jsx)(D.Z,{align:"right",children:e.modifiedBy})]},e.name)}))})]})]}),(0,se.jsx)(I.Z,{children:(0,se.jsx)(j.Z,{onClick:function(){return Ue(!1)},children:te("close")})})]})]})}function Ze(){return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(r.ql,{children:(0,se.jsx)("title",{children:" Dashboard: Invoice List"})}),(0,se.jsx)(me,{})]})}},49088:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(69931),i=t(12065),o=t(64554),s=t(36314),a=t(4567),l=t(13239),c=t(17070),u=t(27216),d=t(80184);function p(e){var n,t=e.title,p=e.total,x=e.icon,h=e.color,f=e.percent,m=e.price,Z=(0,r.nt)().t;return(0,d.jsxs)(s.Z,{spacing:2.5,direction:"row",alignItems:"center",justifyContent:"center",sx:{width:1,minWidth:200},children:[(0,d.jsxs)(s.Z,{alignItems:"center",justifyContent:"center",sx:{position:"relative"},children:[(0,d.jsx)(u.Z,{icon:x,width:32,sx:{color:h,position:"absolute"}}),(0,d.jsx)(l.Z,{variant:"determinate",value:f,size:56,thickness:2,sx:{color:h,opacity:.48}}),(0,d.jsx)(l.Z,{variant:"determinate",value:100,size:56,thickness:3,sx:{top:0,left:0,opacity:.48,position:"absolute",color:function(e){return(0,i.Fq)(e.palette.grey[500],.16)}}})]}),(0,d.jsxs)(s.Z,{spacing:.5,children:[(0,d.jsx)(a.Z,{variant:"subtitle1",children:t}),(0,d.jsxs)(o.Z,{component:"span",sx:{color:"text.disabled",typography:"body2"},children:[(0,c.v1)(p)," ",(n="invoices",Z(n))]}),(0,d.jsx)(a.Z,{variant:"subtitle2",children:(0,c.e_)(m)})]})]})}},10370:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(1413),i=t(45987),o=t(64554),s=t(85771),a=t(27938),l=t(5849),c=t(36314),u=t(27216),d=t(25265),p=t(80184),x=["filters","onFilters","onResetFilters","results"],h=["label","children","sx"];function f(e){var n=e.filters,t=e.onFilters,a=e.onResetFilters,h=e.results,f=(0,i.Z)(e,x),Z=(0,d.l2)(n.startDate,n.endDate);return(0,p.jsxs)(c.Z,(0,r.Z)((0,r.Z)({spacing:1.5},f),{},{children:[(0,p.jsxs)(o.Z,{sx:{typography:"body2"},children:[(0,p.jsx)("strong",{children:h}),(0,p.jsx)(o.Z,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),(0,p.jsxs)(c.Z,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[!!n.service.length&&(0,p.jsx)(m,{label:"Service:",children:n.service.map((function(e){return(0,p.jsx)(s.Z,{label:e,size:"small",onDelete:function(){return function(e){var r=n.service.filter((function(n){return n!==e}));t("service",r)}(e)}},e)}))}),"all"!==n.status&&(0,p.jsx)(m,{label:"Status:",children:(0,p.jsx)(s.Z,{size:"small",label:n.status,onDelete:function(){t("status","all")}})}),n.startDate&&n.endDate&&(0,p.jsx)(m,{label:"Date:",children:(0,p.jsx)(s.Z,{size:"small",label:Z,onDelete:function(){t("startDate",null),t("endDate",null)}})}),(0,p.jsx)(l.Z,{color:"error",onClick:a,startIcon:(0,p.jsx)(u.Z,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]}))}function m(e){var n=e.label,t=e.children,s=e.sx,l=(0,i.Z)(e,h);return(0,p.jsxs)(c.Z,(0,r.Z)((0,r.Z)({component:a.Z,variant:"outlined",spacing:1,direction:"row",sx:(0,r.Z)({p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed"},s)},l),{},{children:[(0,p.jsx)(o.Z,{component:"span",sx:{typography:"subtitle2"},children:n}),(0,p.jsx)(c.Z,{spacing:1,direction:"row",flexWrap:"wrap",children:t})]}))}},11276:function(e,n,t){t.d(n,{p:function(){return s}});var r=t(4942),i=(t(72791),t(25415)),o=t.n(i),s=function(e,n,t,r,i){console.log(e);var s=[];"invoicebydepartments"===r.toLowerCase()?s=a(e,n,t):"allinvoices"===r.toLowerCase()&&(s=l(e,n,t)),console.log("Headers: ",n),console.log("filteredData: ",s);var c=new(o().Workbook),u=c.addWorksheet("Sheet1"),d=u.addRow(n);s.forEach((function(e){var t=n.map((function(n){return e[n]}));u.addRow(t)})),u.columns.forEach((function(e){e.width=19,e.eachCell((function(e){e.font={name:"Arial",size:10,family:4,bold:!1,italic:!1},e.alignment={vertical:"middle",horizontal:"left",wrapText:!1}}))})),d.font={name:"Arial",bold:!0,size:10,color:{argb:"FF000000"}},console.log("Rows count: ",u.rowCount),c.xlsx.writeBuffer().then((function(e){var n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a");t.href=window.URL.createObjectURL(n),t.download="".concat(i,".xlsx"),t.click()}))},a=function(e,n,t){return e.map((function(e){var i;return i={},(0,r.Z)(i,n[0],e.invoiceNo),(0,r.Z)(i,n[1],"ar"===t?e.customerNameAr:e.customerNameEn),(0,r.Z)(i,n[2],e.issueInvoiceDate),(0,r.Z)(i,n[3],e.invoiceAmount),(0,r.Z)(i,n[4],e.region),(0,r.Z)(i,n[5],"ar"===t?e.productNameAr:e.productNameEn),i}))},l=function(e,n,t){return e.map((function(e){var i;return i={},(0,r.Z)(i,n[0],e.invoiceNo),(0,r.Z)(i,n[1],"ar"===t?e.customerNameAr:e.customerNameEn),(0,r.Z)(i,n[2],e.issueInvoiceDate),(0,r.Z)(i,n[3],e.daysToCollected),(0,r.Z)(i,n[4],e.invoiceAmount),(0,r.Z)(i,n[5],e.paidStatus),(0,r.Z)(i,n[6],e.department),i}))}},17070:function(e,n,t){t.d(n,{FK:function(){return o},e_:function(){return s},f2:function(){return a},oe:function(){return c},v1:function(){return l}});var r=t(26098),i=t.n(r);function o(e){return i()(e).format()}function s(e){return u(e?i()(e).format("SAR0,0.00"):"",".00")}function a(e){return u(e?i()(Number(e)/100).format("0.0%"):"",".0")}function l(e){return u(e?i()(e).format("0.00a"):"",".00")}function c(e){return u(e?i()(e).format("0.0 b"):"",".0")}function u(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".00";return e.includes(n)?e.replace(n,""):e}}}]);
//# sourceMappingURL=3931.86cc26ef.chunk.js.map